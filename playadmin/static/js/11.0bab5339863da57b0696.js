webpackJsonp([11],{Uu9s:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a("ZfnU"),i={data:function(){return{dialogVisible2:!1,dialogImageUrl:"",editFlag:!1,baseURL:"http://120.78.121.84:8086/api/upload",form:{status:"normal"},rules:{title:[{required:!0,message:"广告名称不能为空",trigger:"blur"}],status:[{required:!0,message:"状态不能为空",trigger:"blur"}],link_url:[{required:!0,validator:function(t,e,a){return e?/^https?:\/\/(([a-zA-Z0-9_-])+(\.)?)*(:\d+)?(\/((\.)?(\?)?=?&?[a-zA-Z0-9_-](\?)?)*)*$/i.test(e)?void a():a(new Error("链接格式不正确")):a(new Error("链接不能为空"))},trigger:"blur"}],image_url:[{required:!0,message:"广告图片不能为空",trigger:"blur"}]},edit:+this.$route.params.editid,flag:+this.$route.params.flag}},created:function(){var t=this;-1==this.flag?(Object(r.c)({id:+this.$route.params.editid}).then(function(e){t.form=e.data.data}),this.$route.meta.title="编辑广告"):this.$route.meta.title="添加广告"},methods:{handlePictureCardPreview:function(t){this.dialogImageUrl=t,this.dialogVisible2=!0},goBack:function(){this.$router.go(-1)},beforeAvatarUpload:function(t){console.log(t);var e=["image/jpeg","image/gif","image/png"].includes(t.type);return e||this.$message.error("图片格式不正确!"),e},handleImageScucess:function(t,e,a){this.form.image_url=t.data},submitRes:function(t){var e=this;this.$refs[t].validate(function(t){if(!t)return!1;-1==e.flag?Object(r.b)({id:e.form.id,title:e.form.title,link_url:e.form.link_url,image_url:e.form.image_url,status:e.form.status}).then(function(t){200==t.status&&0==t.data.code?(e.$message({message:"修改成功",type:"success"}),e.$router.push({name:"Ads"})):e.$message({message:t.data.message||"修改失敗",type:"warning"})}):Object(r.a)({title:e.form.title,link_url:e.form.link_url,image_url:e.form.image_url,status:e.form.status}).then(function(t){200==t.status&&0==t.data.code?(e.$message({message:"添加成功",type:"success"}),e.$router.push({name:"Ads"})):e.$message({message:t.data.message||"添加失敗",type:"warning"})})})}}},s={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,"label-width":"120px"}},[a("el-form-item",{staticStyle:{width:"500px"},attrs:{label:"广告名称：",prop:"title"}},[a("el-input",{attrs:{placeholder:"请输入广告名称"},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),t._v(" "),a("el-form-item",{staticStyle:{width:"500px"},attrs:{label:"广告状态：",prop:"image_url"}},[a("el-upload",{staticClass:"upload-demo",attrs:{"before-upload":t.beforeAvatarUpload,drag:"","on-success":t.handleImageScucess,action:t.baseURL}},[a("i",{staticClass:"el-icon-upload"}),t._v(" "),a("div",{staticClass:"el-upload__text"},[t._v("将文件拖到此处，或"),a("em",[t._v("点击上传")])])])],1),t._v(" "),t.form.image_url?a("div",{staticStyle:{"margin-left":"20px",display:"inline-block"}},[a("img",{staticStyle:{"max-width":"400px","max-height":"320px",cursor:"pointer","vertical-align":"middle"},attrs:{src:t.form.image_url,alt:""},on:{click:function(e){t.handlePictureCardPreview(t.form.image_url)}}})]):t._e(),t._v(" "),a("br"),a("br"),t._v(" "),a("el-form-item",{staticStyle:{width:"500px"},attrs:{label:"跳转链接：",prop:"link_url"}},[a("el-input",{attrs:{placeholder:"请输入跳转链接"},model:{value:t.form.link_url,callback:function(e){t.$set(t.form,"link_url",e)},expression:"form.link_url"}})],1),t._v(" "),a("el-form-item",{staticStyle:{width:"500px"},attrs:{label:"广告状态：",prop:"status"}},[a("el-radio-group",{model:{value:t.form.status,callback:function(e){t.$set(t.form,"status",e)},expression:"form.status"}},[a("el-radio",{attrs:{label:"normal"}},[t._v("上架")]),t._v(" "),a("el-radio",{attrs:{label:"stop"}},[t._v("下架")])],1)],1),t._v(" "),a("el-form-item",{attrs:{label:""}},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submitRes("form")}}},[t._v("确定")]),t._v(" "),a("el-button",{on:{click:function(e){t.goBack()}}},[t._v("返回")])],1)],1),t._v(" "),a("el-dialog",{attrs:{visible:t.dialogVisible2},on:{"update:visible":function(e){t.dialogVisible2=e}}},[a("img",{attrs:{width:"100%",src:t.dialogImageUrl,alt:""}})])],1)},staticRenderFns:[]},l=a("VU/8")(i,s,!1,null,null,null);e.default=l.exports},ZfnU:function(t,e,a){"use strict";e.d=function(t){return Object(s.a)({url:"/api/banner/search",method:"POST",data:i()(t),headers:{"Content-Type":"application/json;charset=utf-8"}})},e.c=function(t){return Object(s.a)({url:"/api/banner/"+t.id,method:"get",params:t})},e.a=function(t){return Object(s.a)({url:"/api/banner",method:"post",data:i()(t),headers:{"Content-Type":"application/json;charset=utf-8"}})},e.b=function(t){return Object(s.a)({url:"/api/banner",method:"PUT",data:i()(t),headers:{"Content-Type":"application/json;charset=utf-8"}})};var r=a("mvHQ"),i=a.n(r),s=a("vLgD")}});