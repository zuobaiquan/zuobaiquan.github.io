webpackJsonp([8],{AaXs:function(e,t,a){"use strict";t.g=function(e){return Object(r.a)({url:"/api/game/search",method:"post",data:s()(e),headers:{"Content-Type":"application/json;charset=utf-8"}})},t.f=function(e){return Object(r.a)({url:"/api/game/type",method:"get",params:e})},t.e=function(e){return Object(r.a)({url:"/api/game/"+e.id,method:"get",params:e})},t.a=function(e){return Object(r.a)({url:"/api/game",method:"post",data:s()(e),headers:{"Content-Type":"application/json;charset=utf-8"}})},t.d=function(e){return Object(r.a)({url:"/api/game",method:"PUT",data:s()(e),headers:{"Content-Type":"application/json;charset=utf-8"}})},t.b=function(e){return Object(r.a)({url:"/api/game",method:"DELETE",params:e})},t.c=function(e){return Object(r.a)({url:"/api/game/item",method:"DELETE",params:e})};var i=a("mvHQ"),s=a.n(i),r=a("vLgD")},BFPD:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("AaXs"),s={data:function(){return{dialogVisible2:!1,dialogImageUrl:"",gameLevelschecked:!1,gameAreachecked:!1,baseURL:"http://120.78.121.84:8086/api/upload",form:{name:null,price:"",status:"",icon:""},gameLevels:[],gameLevelsList:[],gameAreas:[],gameAreasList:[],rules:{name:[{required:!0,message:"名称不能为空",trigger:"blur"}],icon:[{required:!0,message:"游戏图标不能为空",trigger:"blur"}],status:[{required:!0,message:"状态不能为空",trigger:"blur"}],price:[{required:!0,validator:function(e,t,a){return t?/(^[1-9]{1}[0-9]*$)|(^[0-9]*\.[0-9]{1,2}$)/.test(t)?void a():a(new Error("价格格式不正确")):a(new Error("价格不为空"))},trigger:"blur"}]},edit:this.$route.params.id,flag:this.$route.params.flag,dialogFormVisible:!1,dialogTitle:"",addType:"",addValue:"",gameWayList:[]}},created:function(){var e=this;Object(i.f)({type:1}).then(function(t){e.gameWayList=t.data.data}),-1==this.flag?(Object(i.e)({id:this.edit}).then(function(t){e.form=t.data.data}),this.getGameLevel(),this.getGameAreas(),this.$route.meta.title="编辑游戏"):this.$route.meta.title="添加游戏"},methods:{goBack:function(){this.$router.go(-1)},getGameLevel:function(){var e=this;Object(i.f)({type:2}).then(function(t){var a=[];e.gameLevelsList=t.data.data,t.data.data.length>0&&t.data.data.map(function(e,t){a.push(e.name)}),e.gameLevels=a,e.gameLevelschecked=!0})},getGameAreas:function(){var e=this;Object(i.f)({type:3}).then(function(t){var a=[];e.gameAreasList=t.data.data,t.data.data.length>0&&t.data.data.map(function(e,t){a.push(e.name)}),e.gameAreas=a,e.gameAreachecked=!0})},beforeAvatarUpload:function(e){var t=["image/jpeg","image/gif","image/png"].includes(e.type);return t||this.$message.error("图片格式不正确!"),t},handleImageScucess:function(e,t,a){this.form.icon=e.data},addGameBytype:function(e){this.addType=e,this.dialogFormVisible=!0,"grade"==e?this.dialogTitle="添加游戏等级":"area"==e&&(this.dialogTitle="添加游戏大区")},deleteBytype:function(e,t){var a=this;if(-1==this.flag){this.$confirm("是否确认删除？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var s="";"grade"==e&&a.gameLevelsList.map(function(e,a){t==a&&(s=e.id)}),"area"==e&&a.gameAreasList.map(function(e,a){t==a&&(s=e.id)}),Object(i.c)({id:s}).then(function(t){200==t.status&&0==t.data.code?(a.$message({type:"success",message:"已删除"}),"grade"==e?a.getGameLevel():"area"==e&&a.getGameAreas()):a.$message({message:t.data.message||"操作失败",type:"warning"})})}).catch(function(){a.$message({type:"info",message:"已取消删除"})})}else"grade"==e?this.gameLevels.splice(t,1):"area"==e&&this.gameAreas.splice(t,1)},addSubmit:function(){if(this.addValue){if("grade"==this.addType){if(this.gameLevels.includes(this.addValue))return void this.$message({message:"游戏等级名称已存在",type:"warning"});this.gameLevels.push(this.addValue),this.dialogFormVisible=!1,this.addValue=""}else if("area"==this.addType){if(this.gameAreas.includes(this.addValue))return void this.$message({message:"游戏大厅名称已存在",type:"warning"});this.gameAreas.push(this.addValue),this.dialogFormVisible=!1,this.addValue=""}}else this.$message({message:"grade"==this.addType?"游戏等级名称不为空":"游戏大厅名称不为空",type:"warning"})},handlePictureCardPreview:function(e){this.dialogImageUrl=e,this.dialogVisible2=!0},handelErrorForm:function(){if(0!=this.gameLevels.length)return 0!=this.gameAreas.length||void this.$message({message:"请添加游戏大区",type:"warning"});this.$message({message:"请添加游戏等级",type:"warning"})},submitRes:function(e){var t=this;this.$refs[e].validate(function(e){if(!e||!t.handelErrorForm())return!1;-1==t.flag?Object(i.d)({id:t.form.id,name:t.form.name,price:t.form.price,icon:t.form.icon,status:t.form.status}).then(function(e){200==e.status&&0==e.data.code?(t.$message({message:"修改成功",type:"success"}),t.$router.replace({name:"Game"})):t.$message({message:e.data.message||"添加失败",type:"warning"})}):Object(i.a)({name:t.form.name,price:t.form.price,gameAreas:t.gameAreas,icon:t.form.icon,gameLevels:t.gameLevels,status:t.form.status}).then(function(e){200==e.status&&0==e.data.code?(t.$message({message:"添加成功",type:"success"}),t.$router.replace({name:"Game"})):t.$message({message:e.data.message||"添加失败",type:"warning"})})})}}},r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"游戏名称：",prop:"name"}},[a("el-input",{staticStyle:{width:"250px"},attrs:{placeholder:"请输入游戏名称"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"价格设置：",prop:"price"}},[a("el-input",{staticStyle:{width:"250px","margin-right":"10px"},attrs:{placeholder:"请输入价格设置"},model:{value:e.form.price,callback:function(t){e.$set(e.form,"price",t)},expression:"form.price"}}),e._v("元\n    ")],1),e._v(" "),a("el-form-item",{attrs:{label:"图标：",prop:"icon"}},[a("el-upload",{staticClass:"upload-demo",staticStyle:{display:"inline-block"},attrs:{"before-upload":e.beforeAvatarUpload,drag:"","on-success":e.handleImageScucess,action:e.baseURL}},[a("i",{staticClass:"el-icon-upload"}),e._v(" "),a("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),a("em",[e._v("点击上传")])])]),e._v(" "),e.form.icon?a("div",{staticStyle:{"margin-left":"20px",display:"inline-block"}},[a("img",{staticStyle:{width:"100px",height:"100px",cursor:"pointer","vertical-align":"middle"},attrs:{src:e.form.icon,alt:""},on:{click:function(t){e.handlePictureCardPreview(e.form.icon)}}})]):e._e()],1),e._v(" "),a("br"),a("br"),e._v(" "),a("el-form-item",{attrs:{label:"状态",prop:"status"}},[a("el-radio-group",{model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}},[a("el-radio",{attrs:{label:"normal"}},[e._v("上架")]),e._v(" "),a("el-radio",{attrs:{label:"stop"}},[e._v("下架")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"游戏玩法："}},e._l(e.gameWayList,function(t,i){return a("span",{staticStyle:{color:"#606266","margin-right":"30px"}},[e._v(e._s(t.name))])})),e._v(" "),a("el-form-item",{attrs:{label:""}},[a("el-checkbox",{model:{value:e.gameLevelschecked,callback:function(t){e.gameLevelschecked=t},expression:"gameLevelschecked"}},[e._v("游戏等级：")]),e._v(" "),a("el-button",{attrs:{size:"mini",disabled:!e.gameLevelschecked,type:e.gameLevelschecked?"primary":""},on:{click:function(t){e.addGameBytype("grade")}}},[e._v("添加游戏等级")]),e._v(" "),e._l(e.gameLevels,function(t,i){return e.gameLevels.length>0?a("el-button-group",{key:i,staticStyle:{"margin-left":"10px"}},[a("el-button",{attrs:{size:"mini"}},[e._v(e._s(t))]),e._v(" "),a("el-button",{attrs:{size:"mini",icon:"el-icon-delete"},on:{click:function(t){e.deleteBytype("grade",i)}}})],1):e._e()})],2),e._v(" "),a("el-form-item",{attrs:{label:""}},[a("el-checkbox",{model:{value:e.gameAreachecked,callback:function(t){e.gameAreachecked=t},expression:"gameAreachecked"}},[e._v("游戏大区：")]),e._v(" "),a("el-button",{attrs:{size:"mini",disabled:!e.gameAreachecked,type:e.gameAreachecked?"primary":""},on:{click:function(t){e.addGameBytype("area")}}},[e._v("添加游戏大区")]),e._v(" "),e._l(e.gameAreas,function(t,i){return e.gameAreas.length>0?a("el-button-group",{key:i,staticStyle:{"margin-left":"10px"}},[a("el-button",{attrs:{size:"mini"}},[e._v(e._s(t))]),e._v(" "),a("el-button",{attrs:{size:"mini",icon:"el-icon-delete"},on:{click:function(t){e.deleteBytype("area",i)}}})],1):e._e()})],2),e._v(" "),a("el-form-item",{attrs:{label:""}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitRes("form")}}},[e._v("确定")]),e._v(" "),a("el-button",{on:{click:function(t){e.goBack()}}},[e._v("返回")])],1)],1),e._v(" "),a("el-dialog",{staticStyle:{width:"60%",margin:"0 auto"},attrs:{title:e.dialogTitle,visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{staticStyle:{"text-align":"center"}},[a("el-form-item",{attrs:{label:""}},[a("el-input",{staticStyle:{width:"70%"},attrs:{placeholder:"grade"==e.addType?"请输入游戏等级名称":"请输入游戏大厅名称","auto-complete":"off"},model:{value:e.addValue,callback:function(t){e.addValue=t},expression:"addValue"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addSubmit()}}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{visible:e.dialogVisible2},on:{"update:visible":function(t){e.dialogVisible2=t}}},[a("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})])],1)},staticRenderFns:[]},n=a("VU/8")(s,r,!1,null,null,null);t.default=n.exports}});