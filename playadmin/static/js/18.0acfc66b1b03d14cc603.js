webpackJsonp([18],{DuGa:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i("V/8j"),a=i("vMJZ"),o={data:function(){return{form:{content:"",type:""},rules:{content:[{required:!0,message:"内容不能为空",trigger:"blur"}],type:[{required:!0,message:"请选择发送对象",trigger:"blur"}]},dialogFormVisible:!1,addValue:"",userList:[],uids:[]}},created:function(){},methods:{addUser:function(e){this.dialogFormVisible=!0},querySearch:function(e,t){e&&Object(a.h)({pageNo:1,pageSize:100,keyword:this.addValue}).then(function(e){var i=[];(e=e.data.data.records).length>0&&e.map(function(e,t){i.push({value:e.nickname,uid:e.id})}),t(i)})},handleSelect:function(e){this.uids.push(e.uid)},deleteBytype:function(e){this.userList.splice(e,1)},addSubmit:function(){this.addValue?this.userList.includes(this.addValue)?this.$message({message:"用户名称已存在",type:"warning"}):(this.userList.push(this.addValue),this.dialogFormVisible=!1,this.addValue=""):this.$message({message:"用户名称不能为空",type:"warning"})},submitRes:function(e){var t=this;"section"!=this.form.type||0!=this.uids.length?this.$refs[e].validate(function(e){if(e){var i={content:t.form.content,type:t.form.type,uids:[]};"section"==t.form.type&&(i.uids=t.uids),Object(s.b)(i).then(function(e){200==e.status&&0==e.data.code?(t.$message({message:"添加成功",type:"success"}),t.$router.replace({name:"noticeList"})):t.$message({message:e.data.message||"添加失败",type:"warning"})})}}):this.$message({message:"请添加发送用户",type:"warning"})}}},l={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container"},[i("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"120px"}},[i("el-form-item",{attrs:{prop:"content",label:"发送内容："}},[i("el-input",{attrs:{type:"textarea",rows:5,placeholder:"请输入内容"},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"发送对象：",prop:"type"}},[i("el-radio",{attrs:{label:"all"},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},[e._v("全部对象")]),e._v(" "),i("el-radio",{attrs:{label:"section"},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},[e._v("部分对象")])],1),e._v(" "),"section"==e.form.type?i("el-form-item",{attrs:{label:""}},[i("el-button",{attrs:{size:"mini"},on:{click:function(t){e.addUser()}}},[e._v("添加用户")])],1):e._e(),e._v(" "),i("el-form-item",{attrs:{label:""}},e._l(e.userList,function(t,s){return e.userList.length>0?i("el-button-group",{key:s,staticStyle:{"margin-left":"10px"}},[i("el-button",{attrs:{size:"mini"}},[e._v(e._s(t))]),e._v(" "),i("el-button",{attrs:{size:"mini",icon:"el-icon-delete"},on:{click:function(t){e.deleteBytype(s)}}})],1):e._e()})),e._v(" "),i("el-form-item",{attrs:{label:""}},[i("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitRes("form")}}},[e._v("确定")]),e._v(" "),i("el-button",{on:{click:function(t){e.goBack()}}},[e._v("返回")])],1)],1),e._v(" "),i("el-dialog",{staticStyle:{width:"60%",margin:"0 auto"},attrs:{title:"添加用户",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[i("el-form",{staticStyle:{"text-align":"center"}},[i("el-form-item",{attrs:{label:""}},[i("el-autocomplete",{staticStyle:{width:"80%"},attrs:{"fetch-suggestions":e.querySearch,placeholder:"请输入用户昵称","trigger-on-focus":!1},on:{select:e.handleSelect},model:{value:e.addValue,callback:function(t){e.addValue=t},expression:"addValue"}})],1)],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addSubmit("form")}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]},n=i("VU/8")(o,l,!1,null,null,null);t.default=n.exports}});