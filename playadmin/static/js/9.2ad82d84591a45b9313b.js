webpackJsonp([9],{AaXs:function(e,a,t){"use strict";a.h=function(e){return Object(l.a)({url:"/api/game/search",method:"post",data:s()(e),headers:{"Content-Type":"application/json;charset=utf-8"}})},a.f=function(e){return Object(l.a)({url:"/api/game/"+e.id,method:"get",params:e})},a.a=function(e){return Object(l.a)({url:"/api/game",method:"post",data:s()(e),headers:{"Content-Type":"application/json;charset=utf-8"}})},a.e=function(e){return Object(l.a)({url:"/api/game",method:"PUT",data:s()(e),headers:{"Content-Type":"application/json;charset=utf-8"}})},a.c=function(e){return Object(l.a)({url:"/api/game",method:"DELETE",params:e})},a.b=function(e){return Object(l.a)({url:"/api/game/item",method:"post",data:s()(e),headers:{"Content-Type":"application/json;charset=utf-8"}})},a.d=function(e){return Object(l.a)({url:"/api/game/item",method:"DELETE",params:e})},a.g=function(e){return Object(l.a)({url:"/api/game/item/type}",method:"get",params:e})};var i=t("mvHQ"),s=t.n(i),l=t("vLgD")},BFPD:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i=t("AaXs"),s={data:function(){return{dialogVisible2:!1,dialogImageUrl:"",gamePlayschecked:!1,gameLevelschecked:!1,gameAreachecked:!1,baseURL:"http://120.78.121.84:8086/api/upload",form:{name:null,price:"",status:"",icon:""},gamePlays:[],gamePlaysList:[],gameLevels:[],gameLevelsList:[],gameAreas:[],gameAreasList:[],rules:{name:[{required:!0,message:"名称不能为空",trigger:"blur"}],icon:[{required:!0,message:"游戏图标不能为空",trigger:"blur"}],status:[{required:!0,message:"状态不能为空",trigger:"blur"}],price:[{required:!0,validator:function(e,a,t){return a?/(^[1-9]{1}[0-9]*$)|(^[0-9]*\.[0-9]{1,2}$)/.test(a)?void t():t(new Error("价格格式不正确")):t(new Error("价格不为空"))},trigger:"blur"}]},edit:this.$route.params.id,flag:this.$route.params.flag,dialogFormVisible:!1,dialogTitle:"",addType:"",addValue:"",gameWayList:[]}},created:function(){var e=this;-1==this.flag?(Object(i.f)({id:this.edit}).then(function(a){e.form=a.data.data}),this.getGamePlay(),this.getGameLevel(),this.getGameAreas(),this.$route.meta.title="编辑游戏"):this.$route.meta.title="添加游戏"},methods:{goBack:function(){this.$router.go(-1)},getGamePlay:function(){var e=this;console.log(this.form),Object(i.g)({typeId:1,gameId:this.edit}).then(function(a){var t=[];e.gamePlaysList=a.data.data,a.data.data.length>0&&a.data.data.map(function(e,a){t.push(e.name)}),e.gamePlays=t,e.gamePlayschecked=!0})},getGameLevel:function(){var e=this;Object(i.g)({typeId:2,gameId:this.edit}).then(function(a){var t=[];e.gameLevelsList=a.data.data,a.data.data.length>0&&a.data.data.map(function(e,a){t.push(e.name)}),e.gameLevels=t,e.gameLevelschecked=!0})},getGameAreas:function(){var e=this;Object(i.g)({typeId:3,gameId:this.edit}).then(function(a){var t=[];e.gameAreasList=a.data.data,a.data.data.length>0&&a.data.data.map(function(e,a){t.push(e.name)}),e.gameAreas=t,e.gameAreachecked=!0})},beforeAvatarUpload:function(e){var a=["image/jpeg","image/gif","image/png"].includes(e.type);return a||this.$message.error("图片格式不正确!"),a},handleImageScucess:function(e,a,t){this.form.icon=e.data},addGameBytype:function(e){this.addType=e,this.dialogFormVisible=!0,"grade"==e?this.dialogTitle="添加游戏等级":"area"==e?this.dialogTitle="添加游戏大区":"play"==e&&(this.dialogTitle="添加游戏玩法")},deleteBytype:function(e,a){var t=this;if(-1==this.flag){this.$confirm("是否确认删除？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var s="";"play"==e&&t.gamePlaysList.map(function(e,t){a==t&&(s=e.id)}),"grade"==e&&t.gameLevelsList.map(function(e,t){a==t&&(s=e.id)}),"area"==e&&t.gameAreasList.map(function(e,t){a==t&&(s=e.id)}),Object(i.d)({id:s}).then(function(a){200==a.status&&0==a.data.code?(t.$message({type:"success",message:"已删除"}),"play"==e&&t.getGamePlay(),"grade"==e?t.getGameLevel():"area"==e&&t.getGameAreas()):t.$message({message:a.data.message||"操作失败",type:"warning"})})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})}else"grade"==e?this.gameLevels.splice(a,1):"area"==e?this.gameAreas.splice(a,1):"play"==e&&this.gamePlays.splice(a,1)},addSubmit:function(){if(this.addValue){if("grade"==this.addType){if(this.gameLevels.includes(this.addValue))return void this.$message({message:"游戏等级名称已存在",type:"warning"});this.handelAddType()}else if("area"==this.addType){if(this.gameAreas.includes(this.addValue))return void this.$message({message:"游戏大区名称已存在",type:"warning"});this.handelAddType()}else if("play"==this.addType){if(this.gamePlays.includes(this.addValue))return void this.$message({message:"游戏玩法名称已存在",type:"warning"});this.handelAddType()}}else this.$message({message:"grade"==this.addType?"游戏等级名称不为空":"area"==this.addType?"游戏大区名称不为空":"游戏玩法名称不为空",type:"warning"})},handelAddType:function(){var e=this;Object(i.b)({gameId:this.edit,gameTypeId:"play"==this.addType?1:"area"==this.addType?3:2,name:this.addValue}).then(function(a){200==a.status&&0==a.data.code?(e.addValue="",e.$message({message:"添加成功",type:"success"}),e.dialogFormVisible=!1,"play"==e.addType?e.getGamePlay():"area"==e.addType?e.getGameAreas():"grade"==e.addType&&e.getGameLevel()):e.$message({message:a.data.message||"添加失败",type:"warning"})})},handlePictureCardPreview:function(e){this.dialogImageUrl=e,this.dialogVisible2=!0},handelErrorForm:function(){if(0!=this.gameLevels.length)return 0!=this.gameAreas.length||void this.$message({message:"请添加游戏大区",type:"warning"});this.$message({message:"请添加游戏等级",type:"warning"})},submitRes:function(e){var a=this;this.$refs[e].validate(function(e){if(!e)return!1;-1==a.flag?(a.handelErrorForm(),Object(i.e)({id:a.edit,name:a.form.name,price:a.form.price,icon:a.form.icon,status:a.form.status}).then(function(e){200==e.status&&0==e.data.code?(a.$message({message:"修改成功",type:"success"}),a.$router.replace({name:"Game"})):a.$message({message:e.data.message||"修改失败",type:"warning"})})):Object(i.a)({name:a.form.name,price:a.form.price,icon:a.form.icon,status:a.form.status}).then(function(e){200==e.status&&0==e.data.code?(a.$message({message:"添加成功",type:"success"}),a.$router.replace({name:"Game"})):a.$message({message:e.data.message||"添加失败",type:"warning"})})})}}},l={render:function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"app-container"},[t("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"120px"}},[t("el-form-item",{attrs:{label:"游戏名称：",prop:"name"}},[t("el-input",{staticStyle:{width:"250px"},attrs:{placeholder:"请输入游戏名称"},model:{value:e.form.name,callback:function(a){e.$set(e.form,"name",a)},expression:"form.name"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"价格设置：",prop:"price"}},[t("el-input",{staticStyle:{width:"250px","margin-right":"10px"},attrs:{placeholder:"请输入价格设置"},model:{value:e.form.price,callback:function(a){e.$set(e.form,"price",a)},expression:"form.price"}}),e._v("元\n    ")],1),e._v(" "),t("el-form-item",{attrs:{label:"图标：",prop:"icon"}},[t("el-upload",{staticClass:"upload-demo",staticStyle:{display:"inline-block"},attrs:{"before-upload":e.beforeAvatarUpload,drag:"","on-success":e.handleImageScucess,action:e.baseURL}},[t("i",{staticClass:"el-icon-upload"}),e._v(" "),t("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),t("em",[e._v("点击上传")])])]),e._v(" "),e.form.icon?t("div",{staticStyle:{"margin-left":"20px",display:"inline-block"}},[t("img",{staticStyle:{width:"100px",height:"100px",cursor:"pointer","vertical-align":"middle"},attrs:{src:e.form.icon,alt:""},on:{click:function(a){e.handlePictureCardPreview(e.form.icon)}}})]):e._e()],1),e._v(" "),t("br"),t("br"),e._v(" "),t("el-form-item",{attrs:{label:"状态",prop:"status"}},[t("el-radio-group",{model:{value:e.form.status,callback:function(a){e.$set(e.form,"status",a)},expression:"form.status"}},[t("el-radio",{attrs:{label:"normal"}},[e._v("上架")]),e._v(" "),t("el-radio",{attrs:{label:"stop"}},[e._v("下架")])],1)],1),e._v(" "),-1==e.flag?t("el-form-item",{attrs:{label:""}},[t("el-checkbox",{model:{value:e.gamePlayschecked,callback:function(a){e.gamePlayschecked=a},expression:"gamePlayschecked"}},[e._v("游戏玩法：")]),e._v(" "),t("el-button",{attrs:{size:"mini",disabled:!e.gamePlayschecked,type:e.gamePlayschecked?"primary":""},on:{click:function(a){e.addGameBytype("play")}}},[e._v("添加游戏玩法")]),e._v(" "),e._l(e.gamePlays,function(a,i){return e.gamePlays.length>0?t("el-button-group",{key:i,staticStyle:{"margin-left":"10px"}},[t("el-button",{attrs:{size:"mini"}},[e._v(e._s(a))]),e._v(" "),t("el-button",{attrs:{size:"mini",icon:"el-icon-delete"},on:{click:function(a){e.deleteBytype("play",i)}}})],1):e._e()})],2):e._e(),e._v(" "),-1==e.flag?t("el-form-item",{attrs:{label:""}},[t("el-checkbox",{model:{value:e.gameLevelschecked,callback:function(a){e.gameLevelschecked=a},expression:"gameLevelschecked"}},[e._v("游戏等级：")]),e._v(" "),t("el-button",{attrs:{size:"mini",disabled:!e.gameLevelschecked,type:e.gameLevelschecked?"primary":""},on:{click:function(a){e.addGameBytype("grade")}}},[e._v("添加游戏等级")]),e._v(" "),e._l(e.gameLevels,function(a,i){return e.gameLevels.length>0?t("el-button-group",{key:i,staticStyle:{"margin-left":"10px"}},[t("el-button",{attrs:{size:"mini"}},[e._v(e._s(a))]),e._v(" "),t("el-button",{attrs:{size:"mini",icon:"el-icon-delete"},on:{click:function(a){e.deleteBytype("grade",i)}}})],1):e._e()})],2):e._e(),e._v(" "),-1==e.flag?t("el-form-item",{attrs:{label:""}},[t("el-checkbox",{model:{value:e.gameAreachecked,callback:function(a){e.gameAreachecked=a},expression:"gameAreachecked"}},[e._v("游戏大区：")]),e._v(" "),t("el-button",{attrs:{size:"mini",disabled:!e.gameAreachecked,type:e.gameAreachecked?"primary":""},on:{click:function(a){e.addGameBytype("area")}}},[e._v("添加游戏大区")]),e._v(" "),e._l(e.gameAreas,function(a,i){return e.gameAreas.length>0?t("el-button-group",{key:i,staticStyle:{"margin-left":"10px"}},[t("el-button",{attrs:{size:"mini"}},[e._v(e._s(a))]),e._v(" "),t("el-button",{attrs:{size:"mini",icon:"el-icon-delete"},on:{click:function(a){e.deleteBytype("area",i)}}})],1):e._e()})],2):e._e(),e._v(" "),t("el-form-item",{attrs:{label:""}},[t("el-button",{attrs:{type:"primary"},on:{click:function(a){e.submitRes("form")}}},[e._v("确定")]),e._v(" "),t("el-button",{on:{click:function(a){e.goBack()}}},[e._v("返回")])],1)],1),e._v(" "),t("el-dialog",{staticStyle:{width:"60%",margin:"0 auto"},attrs:{title:e.dialogTitle,visible:e.dialogFormVisible},on:{"update:visible":function(a){e.dialogFormVisible=a}}},[t("el-form",{staticStyle:{"text-align":"center"}},[t("el-form-item",{attrs:{label:""}},[t("el-input",{staticStyle:{width:"70%"},attrs:{placeholder:"grade"==e.addType?"请输入游戏等级名称":"play"==e.addType?"请输入游戏玩法名称":"请输入游戏大区名称","auto-complete":"off"},model:{value:e.addValue,callback:function(a){e.addValue=a},expression:"addValue"}})],1)],1),e._v(" "),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(a){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:function(a){e.addSubmit()}}},[e._v("确 定")])],1)],1),e._v(" "),t("el-dialog",{attrs:{visible:e.dialogVisible2},on:{"update:visible":function(a){e.dialogVisible2=a}}},[t("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})])],1)},staticRenderFns:[]},r=t("VU/8")(s,l,!1,null,null,null);a.default=r.exports}});