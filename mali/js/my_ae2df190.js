"use strict";$(function(){function i(){n||(n=!0,tool.ajax("machine:machine?userId="+e+"&page=0&size=200",{},function(i){$("#mysell .mysell-content").children().remove();var a="",e=i.data.content;if(e.length>0)for(var t=function(i){tool.ajax("area:areas/batch",{ids:[e[i].provinceId,e[i].cityId,e[i].districtId].join(",")},function(t){var n=t.data.content,s=n[0].name+n[1].name+n[2].name;e[i].placeName=s,0==i&&$("#onetabmySell").append('<div class="item-content">\n                <img class="item-img fl" src="'+e[0].images[0]+'" alt="">\n                <div class="content-box fr">\n                  <p class="box-name"><span>［拍卖］</span>'+e[0].title+'</p>\n                  <div class="addr"><i></i><span>'+e[0].placeName+'</span></div>\n                  <div class="time"><i></i>'+tool.getDate2(e[0].createTime)+"</div>\n                </div>\n              </div>"),a+='<li class="item">\n              <div class="item-content">\n                <img class="item-img fl" src="'+e[i].images[0]+'" alt="">\n                <div class="content-box fr">\n                  <p class="box-name">'+e[i].title+'<span class="status-name">'+(0==e[i].audit?"审核中":1==e[i].audit?"在卖":"审核不通过")+'</span></p>\n                  <p class="box-price">￥'+e[i].price+'</p>\n                  <div class="addr">\n                    <i></i><span>'+e[i].placeName+'</span>\n                    <div class="time"><i></i>'+tool.getDate2(e[i].createTime)+'</div>\n                    <div class="box-btn fr">\n                      <a class="not-sell" data-id="'+e[i].id+'" style="display:'+(1==e[i].audit?"block":"none")+'" href="javascript:;">我不卖了</a>\n                      <a class="detail" href="indexdetail.html?id='+e[i].id+'&s=-1">查看详情</a>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </li>'},!1)},n=0;n<e.length;n++)t(n);else a='<div class="no-data">暂无内容</div>';$("#mysell .mysell-content").append(a)}))}function a(i){o&&0==i||s&&1==i||(0==i&&(o=!0),1==i&&(s=!0),tool.ajax("machine:order",{userId:e,page:0,size:200,systemStatus:i,projection:"withMachine"},function(a){if(0==a.code){$("#orderMachine .item").remove();var e="",t=a.data.content;if(t.length>0)for(var n=0;n<t.length;n++)e+='<li class="item last-item">\n              <div class="item-content">\n                <img class="item-img fl" src="'+t[n].machine.images[0]+'" alt="">\n                <div class="content-box fr">\n                  <p class="box-name">'+t[n].machine.title+'<span class="status-name">'+tool.getDate4(t[n].createTime)+'</span></p>\n                  <p class="box-price">'+(0==t[n].payStatus?"待付款":2==t[n].payStatus?"已缴纳定金￥"+t[n].baseOrder.price:"处理中")+'</p>\n                  <div class="addr">\n                    <i></i><span>'+t[n].machine.city.name+" "+t[n].machine.district.name+'</span>\n                    <div class="box-btn fr">\n                      <a href="javascript:;">取消订单</a>\n                      <a class="detail" href="javascript:;">完成</a>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </li>';else e='<div class="no-data">暂无内容</div>';0==i&&$("#orderMachine").append(e),1==i&&$("#selfMachine").append(e)}}))}$(".banner-right li:eq(5)").addClass("active").siblings().removeClass("active");var e=parseInt($.cookie("userId")),t=null,n=!1,s=!1,o=!1;if(e?($(".mycenter-top .avatar").attr("src",$.cookie("avatarFull")),$(".user-info span:last-child").text($.cookie("userMobile")),$.cookie("nickName")&&$(".user-info span.name").text($.cookie("nickName"))):($(".error-tipsbox div").text("请先登陆，再查看个人中心！"),$(".form-tipxbox,.mask").show(),$(".my-know").click(function(){window.location.href="login.html"}),setTimeout(function(){window.location.href="login.html"},2e3)),$(".my-left .left-ulist li").click(function(){var e=$(this).index();$(this).addClass("active").siblings().removeClass("active"),1!=e||n||i(),3!=e||o||a(0),3!=e||s||a(1),$(".my-right").eq(e).show().siblings(".my-right").hide()}),tool.getUrlParam("tag")){var c=tool.getUrlParam("tag")-1;$(".my-left .left-ulist li").eq(c).addClass("active").siblings().removeClass("active"),$(".my-right").eq(c).show().siblings(".my-right").hide(),3==c&&a(0),4==c&&a(1),7!==c&&i()}else i();$("#mysell").on("click",".not-sell",function(){$(".confirm-box,.mask").show(),t=$(this).data("id")}),$(".btn-confirm .first a").click(function(){tool.ajax3("machine:publish/"+t,{},function(a){0==a.code?($(".confirm-box").hide(),$("#form-errorbox,.mask").show(),$(".form-tipxbox").addClass("form-successbox").find(".error-tipsbox div").text("删除成功"),i()):($(".error-tipsbox div").text(a.msg||"删除失败，稍后重试！"),$(".form-tipxbox,.mask").show())})}),$(".btn-confirm .last a").click(function(){$(".confirm-box,.mask").hide()}),$(".close-form,.my-know").click(function(){$(".form-tipxbox,.mask").hide()})});