"use strict";$(function(){$(".header-banner .loginreg-tit").text("用户登录"),$(".login-btn").click(function(){return""==$(".phone-input").val()?($("#loginTips").show().find("i").attr("class","right-icon error-icon"),void $("#loginTips").find("span").text("账号不为空")):""==$(".pass-input").val()?($("#loginTips").show().find("i").attr("class","right-icon error-icon"),void $("#loginTips").find("span").text("密码不为空")):void tool.ajax("user:users/mobile",{mobile:$(".phone-input").val()},function(i){if(0!=i.code||!i.hasOwnProperty("data"))return 0==i.code&&""==i.msg?($("#loginTips").show().find("i").attr("class","right-icon error-icon"),void $("#loginTips").find("span").text("此号码未注册")):($("#loginTips").show().find("i").attr("class","right-icon error-icon"),void $("#loginTips").find("span").text("稍后重试"));var o=i.data,n=i.data.userName;$.ajax({type:"post",url:rootApi+"oauth/token",data:"grant_type=password&username="+n+"&password="+$(".pass-input").val(),headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Basic YXBpOnNlY3JldA=="},success:function(){$.cookie("userId",o.id,{expires:7}),$.cookie("userMobile",o.mobile,{expires:7}),o.avatarFull&&$.cookie("avatarFull",o.avatarFull,{expires:7}),o.nickName&&$.cookie("nickName",o.nickName,{expires:7}),$("#form-errorbox,.mask").show(),$(".my-know").click(function(){history.go(-1)}),setTimeout(function(){history.go(-1)},2500)},error:function(){$("#loginTips").show().find("i").attr("class","right-icon error-icon"),$("#loginTips").find("span").text("用户名或密码错误")}})})})});