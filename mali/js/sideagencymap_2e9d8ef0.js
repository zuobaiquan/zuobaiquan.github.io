"use strict";$(function(){function t(t,e){this._point=t,this._text=e.name,this._child=e.id}function e(t,e,n){this._point=t,this._text=e.name,this._child=e.id,this._number=e.number,this._areaFlag=n}function n(){tool.ajax("area:areas/0/subList",{},function(t){for(var n=t.data.content,l=function(t){var l=n[t];tool.ajax("dealer:dealers",{provinceId:l.id},function(t){l.number=t.data.content.length&&t.data.totalElements,a.level=2;var n=new e(new BMap.Point(l.lng,l.lat),l,a);i.addOverlay(n)})},o=0;o<n.length;o++)l(o)})}$(".banner-right li:eq(4)").addClass("active").siblings().removeClass("active");var a={level:1,provinceId:null,cityId:null,districtId:null},i=new BMap.Map("allmap"),l=new BMap.Point(116,33);i.enableScrollWheelZoom(),i.centerAndZoom(l,5),t.prototype=new BMap.Overlay,t.prototype.initialize=function(t){this._map=t;var e=this._div2=document.createElement("a");e.style.zIndex=BMap.Overlay.getZIndex(this._point.lat),e.setAttribute("href","sideagency.html?id="+this._child),e.setAttribute("class","circlebox"),e.setAttribute("target","_blank");var n=document.createElement("div");n.setAttribute("class","bg-circle"),e.appendChild(n);var a=document.createElement("div");a.setAttribute("class","sm-circle"),e.appendChild(a);var i=document.createElement("div");i.setAttribute("class","line"),e.appendChild(i);var l=document.createElement("div");return l.setAttribute("class","ctx"),l.appendChild(document.createTextNode(this._text)),e.appendChild(l),e.onmouseover=function(){e.style.zIndex=99999999,e.setAttribute("class","circlebox hoverbox")},e.onmouseout=function(){e.setAttribute("class","circlebox")},t.getPanes().labelPane.appendChild(e),e},t.prototype.draw=function(){var t=this._map,e=t.pointToOverlayPixel(this._point);this._div2.style.left=e.x+"px",this._div2.style.top=e.y+"px"},e.prototype=new BMap.Overlay,e.prototype.initialize=function(n){var i=this;this._map=n;var l=this._div=document.createElement("div");l.style.zIndex=BMap.Overlay.getZIndex(this._point.lat),l.setAttribute("data-id",this._child),l.setAttribute("class","map-circle"),l.setAttribute("data-lng",this._point.lng),l.setAttribute("data-lat",this._point.lat);var o=this._span=document.createElement("p");o.setAttribute("class","map-areaname"),l.appendChild(o),o.appendChild(document.createTextNode(this._text));var r=this._span=document.createElement("p");return r.setAttribute("class","map-areanumber"),l.appendChild(r),r.appendChild(document.createTextNode(this._number+"ä¸ª")),l.onmouseover=function(){this.style.zIndex=9999},l.onmouseout=function(){this.style.zIndex=BMap.Overlay.getZIndex(i._point.lat)},l.onclick=function(){if(!a.districtId){var i=parseInt(l.getAttribute("data-id")),o=parseInt(l.getAttribute("data-lng")),r=parseInt(l.getAttribute("data-lat"));2==a.level&&(a.provinceId=i),3==a.level&&(a.cityId=i),tool.ajax("area:areas/"+i+"/subList",{},function(i){n.clearOverlays();var l=new BMap.Point(o,r);n.enableScrollWheelZoom(),n.centerAndZoom(l,2==a.level?8:9);for(var d=function(i,o){2==a.level&&(a.cityId=o[i].id),3==a.level&&(a.districtId=o[i].id),tool.ajax("dealer:dealers",a,function(r){o[i].number=r.data.content.length&&r.data.totalElements,a.level=3;var d=new e(new BMap.Point(o[i].lng,o[i].lat),o[i],a);if(n.addOverlay(d),a.districtId){for(var s=0,c=r.data.content;s<c.length;s++){var p=new t(new BMap.Point(c[s].shopLon,c[s].shopLat),c[s]);n.addOverlay(p)}n.centerAndZoom(l,10)}})},s=0,c=i.data.content;s<c.length;s++)d(s,c)})}},n.getPanes().labelPane.appendChild(l),l},e.prototype.draw=function(){var t=this._map,e=t.pointToOverlayPixel(this._point);this._div.style.left=e.x+"px",this._div.style.top=e.y+"px"},n();var o=function(t){t=t||window.event;var e=(document.getElementById("allmap"),i.getZoom());8>e&&(a={level:1,provinceId:null,cityId:null,districtId:null},i.clearOverlays(),new BMap.Point(116,33),n())};document.addEventListener&&document.addEventListener("DOMMouseScroll",o,!1),window.onmousewheel=document.onmousewheel=o});