"use strict";$(function(){function a(){n||(n=!0,tool.ajax("machine:machine?userId="+t+"&page="+(o-1)+"&size=4",{},function(a){var i="",t=a.data.content;if(t.length>0)for(var e=function(a){tool.ajax("area:areas/batch",{ids:[t[a].provinceId,t[a].cityId,t[a].districtId].join(",")},function(e){var n=e.data.content,s=n[0].name+n[1].name+n[2].name;t[a].placeName=s,0==a&&$("#onetabmySell").append('<div class="item-content">\n                <img class="item-img fl" src="'+t[0].images[0]+'" alt="">\n                <div class="content-box fr">\n                  <p class="box-name"><span>［拍卖］</span>'+t[0].title+'</p>\n                  <div class="addr"><i></i><span>'+t[0].placeName+'</span></div>\n                  <div class="time"><i></i>'+tool.getDate2(t[0].createTime)+"</div>\n                </div>\n              </div>"),i+='<li class="item">\n              <div class="item-content">\n                <img class="item-img fl" src="'+t[a].images[0]+'" alt="">\n                <div class="content-box fr">\n                  <p class="box-name">'+t[a].title+'<span class="status-name">'+(0==t[a].audit?"审核中":1==t[a].audit?"在卖":"审核不通过")+'</span></p>\n                  <p class="box-price">￥'+t[a].price.toFixed(2)+'</p>\n                  <div class="addr">\n                    <i></i><span>'+t[a].placeName+'</span>\n                    <div class="time"><i></i>'+tool.getDate2(t[a].createTime)+'</div>\n                    <div class="box-btn fr">\n                      <a class="not-sell" data-id="'+t[a].id+'" style="display:'+(1==t[a].audit?"block":"none")+'" href="javascript:;">我不卖了</a>\n                      <a class="detail" href="indexdetail.html?id='+t[a].id+'&s=-1">查看详情</a>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </li>'},!1)},n=0;n<t.length;n++)e(n);else i='<div class="no-data">暂无内容</div>';if($("#mysell .mysell-content").append(i),$.jqPaginator){if(a.data.totalPages<o)return;$.jqPaginator("#paginationSell",{totalPages:a.data.totalPages,visiblePages:4,currentPage:o,prev:'<li class="prev"><a href="my.html?tag=2&p='+(o-1)+'">上一页</a></li>',next:'<li class="next"><a href="my.html?tag=2&p='+(o+1)+'">下一页</a></li>',page:'<li class="page"><a href="#">{{page}}</a></li>',onPageChange:function(){$("#paginationSell .page").each(function(){var a=+$(this).find("a").text();$(this).find("a").attr("href","my.html?tag=2&p="+a)})}})}}))}function i(a){l&&0==a||s&&1==a||(0==a&&(l=!0),1==a&&(s=!0),tool.ajax("machine:order",{userId:t,page:o-1,size:4,systemStatus:a,projection:"withMachine"},function(i){if(0==i.code){var t="",e=i.data.content;if(e.length>0)for(var n=0;n<e.length;n++)t+='<li class="item last-item">\n              <div class="item-content">\n                <img class="item-img fl" src="'+e[n].machine.images[0]+'" alt="">\n                <div class="content-box fr">\n                  <p class="box-name">'+e[n].machine.title+'<span class="status-name">'+tool.getDate4(e[n].createTime)+'</span></p>\n                  <p class="box-price">'+(0==e[n].payStatus?"待付款":2==e[n].payStatus?"已缴纳定金￥"+e[n].baseOrder.price.toFixed(2):"处理中")+'</p>\n                  <div class="addr">\n                    <i></i><span>'+e[n].machine.city.name+" "+e[n].machine.district.name+'</span>\n                    <div class="box-btn fr">\n                      <a href="javascript:;">取消订单</a>\n                      <a class="detail" href="javascript:;">完成</a>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </li>';else t='<div class="no-data">暂无内容</div>';if(0==a&&($("#orderMachine").append(t),$.jqPaginator)){if(i.data.totalPages<o)return;$.jqPaginator("#paginationOrder1",{totalPages:i.data.totalPages,visiblePages:5,currentPage:o,prev:'<li class="prev"><a href="my.html?tag=4&p='+(o-1)+'">上一页</a></li>',next:'<li class="next"><a href="my.html?tag=4&p='+(o+1)+'">下一页</a></li>',page:'<li class="page"><a href="#">{{page}}</a></li>',onPageChange:function(){$("#paginationOrder1 .page").each(function(){var a=+$(this).find("a").text();$(this).find("a").attr("href","my.html?tag=4&p="+a)})}})}if(1==a&&($("#selfMachine").append(t),$.jqPaginator)){if(i.data.totalPages<o)return;$.jqPaginator("#paginationOrder2",{totalPages:i.data.totalPages,visiblePages:5,currentPage:o,prev:'<li class="prev"><a href="my.html?tag=5&p='+(o-1)+'">上一页</a></li>',next:'<li class="next"><a href="my.html?tag=5&p='+(o+1)+'">下一页</a></li>',page:'<li class="page"><a href="#">{{page}}</a></li>',onPageChange:function(){$("#paginationOrder2 .page").each(function(){var a=+$(this).find("a").text();$(this).find("a").attr("href","my.html?tag=5&p="+a)})}})}}}))}$(".banner-right li:eq(5)").addClass("active").siblings().removeClass("active");var t=parseInt($.cookie("userId")),e=null,n=!1,s=!1,l=!1,o=+tool.getUrlParam("p")||1;if(t?($(".mycenter-top .avatar").attr("src",$.cookie("avatarFull")),$(".user-info span:last-child").text($.cookie("userMobile")),$.cookie("nickName")&&$(".user-info span.name").text($.cookie("nickName"))):($(".error-tipsbox div").text("请先登陆，再查看个人中心！"),$(".form-tipxbox,.mask").show(),$(".my-know").click(function(){window.location.href="login.html"}),setTimeout(function(){window.location.href="login.html"},2e3)),$(".my-left .left-ulist li").click(function(){o=1;var t=$(this).index();$(this).addClass("active").siblings().removeClass("active"),1!=t||n||a(),3!=t||l||i(0),4!=t||s||i(1),$(".my-right").eq(t).show().siblings(".my-right").hide()}),tool.getUrlParam("tag")){var c=tool.getUrlParam("tag")-1;$(".my-left .left-ulist li").eq(c).addClass("active").siblings().removeClass("active"),$(".my-right").eq(c).show().siblings(".my-right").hide(),3==c&&i(0),4==c&&i(1),7!==c&&a()}else a();$("#mysell").on("click",".not-sell",function(){$(".confirm-box,.mask").show(),e=$(this).data("id")}),$(".btn-confirm .first a").click(function(){tool.ajax3("machine:publish/"+e,{},function(i){0==i.code?($(".confirm-box").hide(),$("#form-errorbox,.mask").show(),$(".form-tipxbox").addClass("form-successbox").find(".error-tipsbox div").text("删除成功"),a()):($(".error-tipsbox div").text(i.msg||"删除失败，稍后重试！"),$(".form-tipxbox,.mask").show())})}),$(".btn-confirm .last a").click(function(){$(".confirm-box,.mask").hide()}),$(".close-form,.my-know").click(function(){$(".form-tipxbox,.mask").hide()})});