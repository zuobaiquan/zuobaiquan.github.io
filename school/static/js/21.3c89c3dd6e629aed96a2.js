webpackJsonp([21],{iZPE:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("//Rb"),o=r("vMJZ"),s=r("t5DY"),i=r("V/8j"),l={data:function(){return{dialogVisible2:!1,dialogImageUrl:"",editFlag:!1,baseURL:"http://figo-medu-cloud.figo.cn/api/vendor:oss/files",form:{},rules:{supperUserEmail:[{required:!0,validator:function(e,t,r){return t?/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(t)?void r():r(new Error("管理員賬號格式不正确")):r(new Error("管理員賬號不能为空"))},trigger:"blur"}],supperUserPassword:[{required:!0,validator:function(e,t,r){return t?/^(?!([a-zA-Z]+|\d+)$)[a-zA-Z\d]{2,32}$/.test(t)?void r():r(new Error("密碼格式不正确")):r(new Error("密碼不能为空"))},trigger:"blur"}],supperUserName:[{required:!0,message:"管理員姓名不能为空",trigger:"blur"}],name:[{required:!0,message:"學校名稱不能为空",trigger:"blur"}],districtId:[{required:!0,message:"請選擇區域",trigger:"blur"}],type:[{required:!0,message:"請選擇類型",trigger:"blur"}],intro:[{required:!0,message:"學校介紹不能為空",trigger:"blur"}]},edit:this.$route.params.editid,flag:this.$route.params.flag,isLoaded:!1,isedit:!1,selectAreaOptions:[],selectSchooltypeOptions:[{id:"Kindergarten",name:"幼兒園"},{id:"PrimarySchool",name:"小學"},{id:"SecondarySchool",name:"中學"}]}},created:function(){var e=this;Object(i.d)({page:0,size:100}).then(function(t){e.selectAreaOptions=t.data.data.content}),-1==this.flag?(this.isedit=!0,Object(a.c)(this.$route.params.editid).then(function(t){e.form=t.data.data,e.form.logo=e.form.logoFull,Object(o.e)(e.form.masterUserId).then(function(t){var r=t.data.data;e.form.supperUserEmail=r.email,e.form.supperUserPassword=r.password,e.form.supperUserName=r.name,e.isLoaded=!0})}),this.$route.meta.title="編輯學校"):(this.isLoaded=!0,this.$route.meta.title="添加學校")},methods:{handlePictureCardPreview:function(e){this.dialogImageUrl=e,this.dialogVisible2=!0},goBack:function(){this.$router.go(-1)},handleImagebeforeUpload:function(e){var t=this,r=new FormData;r.append("files",e),r.append("userId",+adminId),Object(s.a)(r).then(function(e){200==e.status&&(t.form.logo=""+e.data.data.content[0],console.log(t.form.logo))})},submitRes:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;console.log("submit!"),-1==t.flag?Object(a.b)({id:t.form.id,alipayAccount:t.form.alipayAccount,districtId:t.form.districtId,intro:t.form.intro,logo:t.form.logo.replace("",""),wxpayAccount:t.form.wxpayAccount}).then(function(e){200==e.status?(t.$message({message:"修改成功",type:"success"}),t.$router.push({name:"Schools"})):t.$message({message:"修改失敗",type:"warning"})}):Object(a.a)({alipayAccount:t.form.alipayAccount,districtId:t.form.districtId,intro:t.form.intro,logo:t.form.logo.replace("",""),name:t.form.name,supperUserEmail:t.form.supperUserEmail,supperUserName:t.form.supperUserName,supperUserPassword:t.form.supperUserPassword,type:t.form.type,wxpayAccount:t.form.wxpayAccount}).then(function(e){200==e.status?(t.$message({message:"添加成功",type:"success"}),t.$router.push({name:"Schools"})):t.$message({message:"添加失敗",type:"warning"})})})}}},n={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[e.isLoaded?r("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"120px"}},[r("el-form-item",{staticStyle:{width:"500px"},attrs:{label:"學校管理員賬號",prop:"supperUserEmail"}},[r("el-input",{attrs:{disabled:e.isedit,placeholder:"請輸入郵箱"},model:{value:e.form.supperUserEmail,callback:function(t){e.$set(e.form,"supperUserEmail",t)},expression:"form.supperUserEmail"}})],1),e._v(" "),r("el-form-item",{staticStyle:{width:"640px"},attrs:{label:"密碼",prop:"supperUserPassword"}},[r("el-input",{staticStyle:{width:"379px"},attrs:{placeholder:"請輸入密碼",disabled:e.isedit},model:{value:e.form.supperUserPassword,callback:function(t){e.$set(e.form,"supperUserPassword",t)},expression:"form.supperUserPassword"}}),e._v(" "),r("span",[e._v("（數字或密碼組合）")])],1),e._v(" "),r("el-form-item",{staticStyle:{width:"500px"},attrs:{label:"管理員姓名","label-width":"120px",prop:"supperUserName"}},[r("el-input",{attrs:{disabled:e.isedit,placeholder:"請輸入管理員姓名"},model:{value:e.form.supperUserName,callback:function(t){e.$set(e.form,"supperUserName",t)},expression:"form.supperUserName"}})],1),e._v(" "),r("el-form-item",{staticStyle:{width:"500px"},attrs:{label:"學校名稱","label-width":"120px",prop:"name"}},[r("el-input",{attrs:{disabled:e.isedit,placeholder:"請輸入學校名稱"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),r("div",{staticStyle:{display:"inline-block"}},[r("label",{staticClass:"el-form-item__label",staticStyle:{width:"120px"}},[e._v("學校LOGO")]),e._v(" "),r("el-upload",{staticClass:"upload-demo",attrs:{"before-upload":e.handleImagebeforeUpload,"show-file-list":!1,action:e.baseURL,drag:""}},[r("i",{staticClass:"el-icon-upload"}),e._v(" "),r("div",{staticClass:"el-upload__text"},[e._v("將文件拖到此處，或"),r("em",[e._v("點擊上傳")])])])],1),e._v(" "),e.form.logo?r("div",{staticStyle:{"margin-left":"20px",display:"inline-block"}},[r("img",{staticStyle:{"max-width":"400px","max-height":"320px",cursor:"pointer","vertical-align":"middle"},attrs:{src:e.form.logo,alt:""},on:{click:function(t){e.handlePictureCardPreview(e.form.logo)}}})]):e._e(),e._v(" "),r("br"),r("br"),e._v(" "),r("el-form-item",{attrs:{label:"區域：","label-width":"120px",prop:"districtId"}},[r("el-select",{staticClass:"filter-item",attrs:{clearable:"",placeholder:"请选择"},model:{value:e.form.districtId,callback:function(t){e.$set(e.form,"districtId",t)},expression:"form.districtId"}},e._l(e.selectAreaOptions,function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),r("el-form-item",{attrs:{label:"類型：","label-width":"120px",prop:"type"}},[r("el-select",{staticClass:"filter-item",attrs:{disabled:e.isedit,clearable:"",placeholder:"请选择"},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},e._l(e.selectSchooltypeOptions,function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),r("el-form-item",{staticStyle:{width:"700px"},attrs:{label:"學校介紹",prop:"intro"}},[r("el-input",{attrs:{placeholder:"請輸入學校介紹",type:"textarea",autosize:{minRows:6,maxRows:8},"auto-complete":"off"},model:{value:e.form.intro,callback:function(t){e.$set(e.form,"intro",t)},expression:"form.intro"}})],1),e._v(" "),r("el-form-item",{staticStyle:{width:"500px"},attrs:{label:"微信收款賬號",prop:"wxpayAccount"}},[r("el-input",{attrs:{placeholder:"請輸入微信收款賬號"},model:{value:e.form.wxpayAccount,callback:function(t){e.$set(e.form,"wxpayAccount",t)},expression:"form.wxpayAccount"}})],1),e._v(" "),r("el-form-item",{staticStyle:{width:"500px"},attrs:{label:"支付寶收款賬號",prop:"alipayAccount"}},[r("el-input",{attrs:{placeholder:"請輸入支付寶收款賬號"},model:{value:e.form.alipayAccount,callback:function(t){e.$set(e.form,"alipayAccount",t)},expression:"form.alipayAccount"}})],1),e._v(" "),r("el-form-item",{attrs:{label:""}},[r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitRes("form")}}},[e._v("確定")]),e._v(" "),r("el-button",{on:{click:function(t){e.goBack()}}},[e._v("返回")])],1)],1):e._e(),e._v(" "),r("el-dialog",{attrs:{visible:e.dialogVisible2},on:{"update:visible":function(t){e.dialogVisible2=t}}},[r("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})])],1)},staticRenderFns:[]},c=r("/Xao")(l,n,!1,null,null,null);t.default=c.exports}});