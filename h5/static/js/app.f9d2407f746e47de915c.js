webpackJsonp([1],{E2dV:function(t,s){},NHnr:function(t,s,e){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var a={};e.d(a,"parseTime",function(){return F}),e.d(a,"formatTime",function(){return E});var i=e("ZLEe"),n=e.n(i),o=e("MVMM"),r={render:function(){var t=this.$createElement,s=this._self._c||t;return s("div",{attrs:{id:"app"}},[s("router-view")],1)},staticRenderFns:[]};var c=e("vSla")({name:"App"},r,!1,function(t){e("E2dV")},null,null).exports,l=e("zO6J"),u={methods:{nameFormate:function(t){return(t+="").length>=2?t.substr(-2,1)+t.substr(-1,1):t},getUrlParam:function(t){var s=document.location.toString().split("?");if(s.length>1){for(var e,a=s[1].split("&"),i=0;i<a.length;i++)if(null!=(e=a[i].split("="))&&e[0]==t)return e[1];return""}return""}}},h={name:"taskItem",data:function(){return{}},props:{list:{type:Array}},methods:{genHash:function(t){for(var s=5381,e=0,a=(t=t||"").length;e<a;++e)s+=(s<<5)+t.charAt(e).charCodeAt();return(2147483647&s)%12},nameFormate:function(t){return(t+="").length>=2?t.substr(-2,1)+t.substr(-1,1):t}},created:function(){}},m={render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"task-container"},t._l(t.list,function(s,a){return e("div",{staticClass:"task-item"},[e("span",{staticClass:"name",class:"color"+t.genHash(s.name)},[t._v(t._s(t.nameFormate(s.name)))]),t._v(" "),e("div",{staticClass:"item-content"},[e("div",{staticClass:"item-top"},[e("span",[t._v(t._s(t.nameFormate(s.name))),e("span",{staticClass:"item-work"},[t._v(t._s(s.action))])]),t._v(" "),e("span",[t._v(t._s(t._f("parseTime")(s.createTime,"{y}.{m}.{d} {h}:{i}")))])]),t._v(" "),e("div",{staticClass:"work-dec"},[t._v(t._s(s.taskTitle))]),t._v(" "),s.cancelReason?e("div",{staticClass:"cancel-reason"},[t._v("取消原因："+t._s(s.cancelReason))]):t._e()])])}))},staticRenderFns:[]},d={mixins:[u],name:"taskList",data:function(){return{page:0,size:10,recordList:[],isLoading:!0,isOver:!1}},components:{taskItem:e("vSla")(h,m,!1,null,null,null).exports},methods:{getTasklist:function(t,s){var e=t.api+"/api/record?page="+s+"&size="+t.size+"&sort=createTime,desc";this.getUrlParam("date")&&(e=t.api+"/api/record?page="+s+"&size="+t.size+"&date="+this.getUrlParam("date")+"&sort=createTime,desc"),t.$ajax({method:"GET",url:e}).then(function(s){s.data.content.length<t.size&&(t.isOver=!0,t.isLoading=!1),t.recordList=t.recordList.concat(s.data.content)}).catch(function(t){console.log(t)})}},mounted:function(){var t=this;window.onscroll=function(){if(window.screen.height+(document.body.scrollTop||document.documentElement.scrollTop)>=(document.body.scrollHeight||document.documentElement.scrollHeight)){if(t.isOver)return;t.page++,t.getTasklist(t,t.page)}}},created:function(){this.getTasklist(this,this.page)}},p={render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"task-list"},[e("taskItem",{attrs:{list:t.recordList}}),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.isLoading,expression:"isLoading"}],staticClass:"loading-wrap"},[e("i"),t._v(" "),e("span",[t._v("加载中...")])]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.isOver,expression:"isOver"}],staticClass:"loaded"},[t._v("没有更多数据")])],1)},staticRenderFns:[]},v=e("vSla")(d,p,!1,null,null,null).exports,f=e("3cXf"),k=e.n(f),_={mixins:[u],name:"memberList",data:function(){return{page:0,size:10,adminList:[],memberList:[],chosenList:[{id:"",name:""}]}},methods:{genHash:function(t){for(var s=5381,e=0,a=(t=t||"").length;e<a;++e)s+=(s<<5)+t.charAt(e).charCodeAt();return(2147483647&s)%12},chosenMember:function(t){var s=this;"false"!=this.getUrlParam("isSelect")&&(t.isChosen=!t.isChosen,t.isChosen?this.chosenList.push({id:t.id,realName:t.realName}):this.chosenList.map(function(e,a){e.id==t.id&&s.chosenList.splice(a,1)}),console.log(k()(this.chosenList)),window.webkit.messageHandlers.avatarClick.postMessage(k()(this.chosenList)))},getMemberlist:function(t,s){var e=[];this.chosenList.shift(),t.getUrlParam("ids")&&(e=t.getUrlParam("ids").split(",")),t.$ajax({method:"GET",url:t.api+"/api/user?page="+s+"&size="+t.size+"&sort=createTime,desc"}).then(function(s){s.data.content.map(function(s,a){s.randomcolor=parseInt(12*Math.random()+1,10),s.isChosen=!1,e.includes(""+s.id)&&(s.isChosen=!0,t.chosenList.push({id:s.id,realName:s.realName})),0==s.userType&&t.memberList.push(s),1==s.userType&&t.adminList.push(s)})}).catch(function(t){console.log(t)})}},created:function(){this.getMemberlist(this,this.page)}},g={render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"member-list"},[e("div",{staticClass:"top"},[t._v("任务分配给指定员工负责，对方在任务开始和快过期会收到 推送.")]),t._v(" "),e("div",{staticClass:"tit"},[t._v("负责人、管理员")]),t._v(" "),e("ul",{staticClass:"list-item"},t._l(t.adminList,function(s,a){return e("li",{on:{click:function(e){t.chosenMember(s)}}},[e("span",{staticClass:"name-box",class:"color"+t.genHash(s.realName)},[t._v(t._s(t.nameFormate(s.realName)))]),t._v(" "),e("span",{staticClass:"name"},[t._v(t._s(t.nameFormate(s.realName)))]),t._v(" "),e("i",{directives:[{name:"show",rawName:"v-show",value:s.isChosen,expression:"item.isChosen"}],staticClass:"is-chosen"})])})),t._v(" "),e("div",{staticClass:"tit"},[t._v("成员")]),t._v(" "),e("ul",{staticClass:"list-item"},t._l(t.memberList,function(s,a){return e("li",{on:{click:function(e){t.chosenMember(s)}}},[e("span",{staticClass:"name-box",class:"color"+s.randomcolor},[t._v(t._s(t.nameFormate(s.realName)))]),t._v(" "),e("span",{staticClass:"name"},[t._v(t._s(t.nameFormate(s.realName)))]),t._v(" "),e("i",{directives:[{name:"show",rawName:"v-show",value:s.isChosen,expression:"item.isChosen"}],staticClass:"is-chosen"})])}))])},staticRenderFns:[]},w=e("vSla")(_,g,!1,null,null,null).exports,C={name:"taskList",data:function(){return{workshopList:[],showMask:!1}},methods:{getWorkshopList:function(t){var s=t.api+"/api/workshop?page=0&size=100&isDelete=0&sort=createTime,desc";t.$ajax({method:"GET",url:s}).then(function(s){t.workshopList=s.data.data.content}).catch(function(t){console.log(t)})},setStatus:function(t,s){this.workshopList.map(function(e,a){t.id!=e.id||(e.status=s)})},hideWorkshop:function(){this.showMask=!1},resetList:function(){var t=this;this.workshopList.map(function(t,s){t.status=0}),t.$ajax({method:"PUT",url:t.api+"/api/workshop/all",data:t.workshopList}).then(function(s){console.log(t.workshopList)}).catch(function(t){console.log(t)})},confirmList:function(){this.isStatus(this.workshopList)?this.$ajax({method:"PUT",url:this.api+"/api/workshop/all",data:this.workshopList}).then(function(t){window.webkit.messageHandlers.submitClick.postMessage(k()(t.data.data))}).catch(function(t){console.log(t)}):this.showMask=!0},isStatus:function(t){return t.find(function(t){return 0!==t.status})}},created:function(){this.getWorkshopList(this),document.body.className="bgWhite"},beforeDestroy:function(){document.body.className=""}},L={render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"workshop-state"},[e("div",{staticClass:"state-container"},[t._m(0),t._v(" "),e("ul",{staticClass:"workshop-list"},t._l(t.workshopList,function(s,a){return e("li",[e("span",{staticClass:"name"},[t._v(t._s(s.name))]),t._v(" "),e("ul",{staticClass:"status-list"},[e("li",{class:2==s.status?"working":"",on:{click:function(e){t.setStatus(s,2)}}},[t._v("生产中")]),t._v(" "),e("li",{class:3==s.status?"stoping":"",on:{click:function(e){t.setStatus(s,3)}}},[t._v("停产中")]),t._v(" "),e("li",{class:1==s.status?"notwork":"",on:{click:function(e){t.setStatus(s,1)}}},[t._v("非生产")])])])}))]),t._v(" "),e("ul",{staticClass:"btn-list"},[e("li",{on:{click:function(s){t.resetList()}}},[t._v("重置")]),t._v(" "),e("li",{on:{click:function(s){t.confirmList()}}},[t._v("确认")])]),t._v(" "),t.showMask?e("div",{staticClass:"mask"}):t._e(),t._v(" "),t.showMask?e("div",{staticClass:"mask-box"},[e("p",{staticClass:"mask-tit"},[t._v("请先选择车间状态")]),t._v(" "),e("ul",{staticClass:"bottombtn-list"},[e("li",{on:{click:function(s){t.hideWorkshop()}}},[t._v("取消")]),t._v(" "),e("li",{on:{click:function(s){t.hideWorkshop()}}},[t._v("确认")])])]):t._e()])},staticRenderFns:[function(){var t=this.$createElement,s=this._self._c||t;return s("ul",{staticClass:"status-box"},[s("li",{staticClass:"working"},[this._v("生产中")]),this._v(" "),s("li",{staticClass:"stoping"},[this._v("停产中")]),this._v(" "),s("li",{staticClass:"notwork"},[this._v("非生产")])])}]},b=e("vSla")(C,L,!1,null,null,null).exports,M={name:"carSpace",data:function(){return{workspaceList:[],showMask:!1,workName:"",editItem:{},editFlag:-1}},methods:{getWorkshopList:function(t){t.$ajax({method:"GET",url:t.api+"/api/workshop?page=0&size=100&isDelete=0&sort=createTime,desc"}).then(function(s){t.workspaceList=s.data.data.content}).catch(function(t){console.log(t)})},deleteWorkshop:function(t){var s=this;s.$ajax({method:"delete",url:s.api+"/api/workshop/"+t}).then(function(t){0==t.data.code&&s.getWorkshopList(s),console.log(t)}).catch(function(t){console.log(t)})},editWorkshop:function(t){this.editFlag=1,this.showMask=!0,this.editItem=t,this.workName=t.name},hideWorkshop:function(){this.showMask=!1},showAdd:function(){this.editFlag=-1,this.showMask=!0,this.workName=""},confirmEdit:function(){var t=this;""!=t.workName?(1==this.editFlag&&(t.workspaceList.map(function(s,e){s.id==t.editItem.id&&(s.name=t.workName)}),t.$ajax({method:"PUT",url:t.api+"/api/workshop/all",data:t.workspaceList}).then(function(s){t.workName="",t.showMask=!1,console.log(s.data.data)}).catch(function(t){console.log(t)})),-1==this.editFlag&&t.$ajax({method:"post",url:t.api+"/api/workshop",data:{status:0,name:t.workName}}).then(function(s){t.workName="",t.showMask=!1,t.getWorkshopList(t)}).catch(function(t){console.log(t)})):alert("车间名称不为空")}},mounted:function(){var t=this;window.showAdd=function(){t.showAdd()}},created:function(){this.getWorkshopList(this)}},x={render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"car-space"},[e("ul",{staticClass:"space-list"},t._l(t.workspaceList,function(s,a){return e("li",[e("span",{staticClass:"name"},[t._v(t._s(s.name))]),t._v(" "),e("div",{staticClass:"operator"},[e("span",{staticClass:"del",on:{click:function(e){t.deleteWorkshop(s.id)}}}),t._v(" "),e("span",{staticClass:"edit",on:{click:function(e){t.editWorkshop(s)}}})])])})),t._v(" "),t.showMask?e("div",{staticClass:"mask"}):t._e(),t._v(" "),t.showMask?e("div",{staticClass:"mask-box"},[e("p",{staticClass:"mask-tit"},[t._v(t._s(1==t.editFlag?"修改车间名称":"添加车间名称"))]),t._v(" "),e("div",{staticClass:"mask-inputbox"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.workName,expression:"workName"}],staticClass:"mask-input",attrs:{placeholder:"请输入车间名称",type:"text",name:"",value:""},domProps:{value:t.workName},on:{input:function(s){s.target.composing||(t.workName=s.target.value)}}})]),t._v(" "),e("ul",{staticClass:"bottombtn-list"},[e("li",{on:{click:function(s){t.hideWorkshop()}}},[t._v("取消")]),t._v(" "),e("li",{on:{click:function(s){t.confirmEdit()}}},[t._v("确认")])])]):t._e()])},staticRenderFns:[]},N=e("vSla")(M,x,!1,null,null,null).exports;o.a.use(l.a);var T=new l.a({routes:[{path:"/record",name:"taskList",component:v,meta:{title:"操作记录"}},{path:"/",redirect:{name:"taskList"}},{path:"/member",name:"memberList",component:w,meta:{title:"成员管理"}},{path:"/workshop",name:"workshopState",component:b,meta:{title:"选择当前车间状态"}},{path:"/carspace",name:"carSpace",component:N,meta:{title:"管理车间"}}]});function F(t,s){if(t=t.replace(/-/g,"/"),0===arguments.length)return null;10===(t+"").length&&(t=1e3*+t);var e=s||"{y}-{m}-{d} {h}:{i}:{s}",a=new Date(t),i={y:a.getFullYear(),m:a.getMonth()+1,d:a.getDate(),h:a.getHours(),i:a.getMinutes(),s:a.getSeconds(),a:a.getDay()};return e.replace(/{(y|m|d|h|i|s|a)+}/g,function(t,s){var e=i[s];return"a"===s?["一","二","三","四","五","六","日"][e-1]:(t.length>0&&e<10&&(e="0"+e),e||0)})}function E(t,s){t=1e3*+t;var e=new Date(t),a=(Date.now()-e)/1e3;return a<30?"刚刚":a<3600?Math.ceil(a/60)+"分钟前":a<86400?Math.ceil(a/3600)+"小时前":a<172800?"1天前":s?F(t,s):e.getMonth()+1+"月"+e.getDate()+"日"+e.getHours()+"时"+e.getMinutes()+"分"}var y=e("aozt"),S=e.n(y);T.beforeEach(function(t,s,e){t.meta.title&&(document.title=t.meta.title),e()}),o.a.config.productionTip=!1,n()(a).forEach(function(t){o.a.filter(t,a[t])}),o.a.prototype.$ajax=S.a,o.a.prototype.api="http://120.24.183.106:9089",new o.a({el:"#app",router:T,components:{App:c},template:"<App/>"})}},["NHnr"]);
//# sourceMappingURL=app.f9d2407f746e47de915c.js.map