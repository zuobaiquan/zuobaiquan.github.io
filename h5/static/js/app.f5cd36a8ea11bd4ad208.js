webpackJsonp([1],{E2dV:function(t,e){},NHnr:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a={};s.d(a,"parseTime",function(){return E}),s.d(a,"formatTime",function(){return F});var i=s("ZLEe"),n=s.n(i),o=s("MVMM"),r={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},staticRenderFns:[]};var c=s("vSla")({name:"App"},r,!1,function(t){s("E2dV")},null,null).exports,l=s("zO6J"),u={methods:{nameFormate:function(t){return(t+="").length>=2?t.substr(-2,1)+t.substr(-1,1):t},getUrlParam:function(t){var e=document.location.toString().split("?");if(e.length>1){for(var s,a=e[1].split("&"),i=0;i<a.length;i++)if(null!=(s=a[i].split("="))&&s[0]==t)return s[1];return""}return""}}},m={name:"taskItem",data:function(){return{}},props:{list:{type:Array}},methods:{nameFormate:function(t){return(t+="").length>=2?t.substr(-2,1)+t.substr(-1,1):t}},created:function(){}},h={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"task-container"},t._l(t.list,function(e,a){return s("div",{staticClass:"task-item"},[s("span",{staticClass:"name"},[t._v(t._s(t.nameFormate(e.name)))]),t._v(" "),s("div",{staticClass:"item-content"},[s("div",{staticClass:"item-top"},[s("span",[t._v(t._s(t.nameFormate(e.name))),s("span",{staticClass:"item-work"},[t._v(t._s(e.action))])]),t._v(" "),s("span",[t._v(t._s(t._f("parseTime")(e.createTime,"{y}.{m}.{d} {h}:{i}")))])]),t._v(" "),s("div",{staticClass:"work-dec"},[t._v(t._s(e.taskTitle))]),t._v(" "),e.cancelReason?s("div",{staticClass:"cancel-reason"},[t._v("取消原因："+t._s(e.cancelReason))]):t._e()])])}))},staticRenderFns:[]},d={mixins:[u],name:"taskList",data:function(){return{page:0,size:10,recordList:[],isLoading:!0,isOver:!1}},components:{taskItem:s("vSla")(m,h,!1,null,null,null).exports},methods:{getTasklist:function(t,e){var s=t.api+"/api/record?page="+e+"&size="+t.size+"&sort=createTime,desc";this.getUrlParam("date")&&(s=t.api+"/api/record?page="+e+"&size="+t.size+"&date="+this.getUrlParam("date")+"&sort=createTime,desc"),t.$ajax({method:"GET",url:s}).then(function(e){e.data.content.length<t.size&&(t.isOver=!0,t.isLoading=!1),t.recordList=t.recordList.concat(e.data.content)}).catch(function(t){console.log(t)})}},mounted:function(){var t=this;window.onscroll=function(){if(window.screen.height+(document.body.scrollTop||document.documentElement.scrollTop)>=(document.body.scrollHeight||document.documentElement.scrollHeight)){if(t.isOver)return;t.page++,t.getTasklist(t,t.page)}}},created:function(){this.getTasklist(this,this.page)}},p={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"task-list"},[s("taskItem",{attrs:{list:t.recordList}}),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.isLoading,expression:"isLoading"}],staticClass:"loading-wrap"},[s("i"),t._v(" "),s("span",[t._v("加载中...")])]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.isOver,expression:"isOver"}],staticClass:"loaded"},[t._v("没有更多数据")])],1)},staticRenderFns:[]},v=s("vSla")(d,p,!1,null,null,null).exports,f=s("3cXf"),k=s.n(f),_={mixins:[u],name:"memberList",data:function(){return{page:0,size:10,adminList:[],memberList:[],chosenList:[{id:"",name:""}]}},methods:{chosenMember:function(t){var e=this;"false"!=this.getUrlParam("isSelect")&&(t.isChosen=!t.isChosen,t.isChosen?this.chosenList.push({id:t.id,realName:t.realName}):this.chosenList.map(function(s,a){s.id==t.id&&e.chosenList.splice(a,1)}),console.log(k()(this.chosenList)),window.webkit.messageHandlers.avatarClick.postMessage(k()(this.chosenList)))},getMemberlist:function(t,e){var s=[];this.chosenList.shift(),t.getUrlParam("ids")&&(s=t.getUrlParam("ids").split(",")),t.$ajax({method:"GET",url:t.api+"/api/user?page="+e+"&size="+t.size+"&sort=createTime,desc"}).then(function(e){e.data.content.map(function(e,a){e.randomcolor=parseInt(12*Math.random()+1,10),e.isChosen=!1,s.includes(""+e.id)&&(e.isChosen=!0,t.chosenList.push({id:e.id,realName:e.realName})),0==e.userType&&t.memberList.push(e),1==e.userType&&t.adminList.push(e)})}).catch(function(t){console.log(t)})}},created:function(){this.getMemberlist(this,this.page)}},g={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"member-list"},[s("div",{staticClass:"top"},[t._v("任务分配给指定员工负责，对方在任务开始和快过期会收到 推送.")]),t._v(" "),s("div",{staticClass:"tit"},[t._v("负责人、管理员")]),t._v(" "),s("ul",{staticClass:"list-item"},t._l(t.adminList,function(e,a){return s("li",{on:{click:function(s){t.chosenMember(e)}}},[s("span",{staticClass:"name-box",class:"color"+e.randomcolor},[t._v(t._s(t.nameFormate(e.realName)))]),t._v(" "),s("span",{staticClass:"name"},[t._v(t._s(t.nameFormate(e.realName)))]),t._v(" "),s("i",{directives:[{name:"show",rawName:"v-show",value:e.isChosen,expression:"item.isChosen"}],staticClass:"is-chosen"})])})),t._v(" "),s("div",{staticClass:"tit"},[t._v("成员")]),t._v(" "),s("ul",{staticClass:"list-item"},t._l(t.memberList,function(e,a){return s("li",{on:{click:function(s){t.chosenMember(e)}}},[s("span",{staticClass:"name-box",class:"color"+e.randomcolor},[t._v(t._s(t.nameFormate(e.realName)))]),t._v(" "),s("span",{staticClass:"name"},[t._v(t._s(t.nameFormate(e.realName)))]),t._v(" "),s("i",{directives:[{name:"show",rawName:"v-show",value:e.isChosen,expression:"item.isChosen"}],staticClass:"is-chosen"})])}))])},staticRenderFns:[]},w=s("vSla")(_,g,!1,null,null,null).exports,C={name:"taskList",data:function(){return{workshopList:[]}},methods:{getWorkshopList:function(t){var e=t.api+"/api/workshop?page=0&size=100&isDelete=0&sort=createTime,desc";t.$ajax({method:"GET",url:e}).then(function(e){t.workshopList=e.data.data.content}).catch(function(t){console.log(t)})},setStatus:function(t,e){this.workshopList.map(function(s,a){t.id!=s.id||(s.status=e)})},resetList:function(){var t=this;this.workshopList.map(function(t,e){t.status=0}),t.$ajax({method:"PUT",url:t.api+"/api/workshop/all",data:t.workshopList}).then(function(e){console.log(t.workshopList)}).catch(function(t){console.log(t)})},confirmList:function(){this.$ajax({method:"PUT",url:this.api+"/api/workshop/all",data:this.workshopList}).then(function(t){window.webkit.messageHandlers.submitClick.postMessage(k()(t.data.data))}).catch(function(t){console.log(t)})}},created:function(){this.getWorkshopList(this),document.body.className="bgWhite"},beforeDestroy:function(){document.body.className=""}},L={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"workshop-state"},[s("div",{staticClass:"state-container"},[t._m(0),t._v(" "),s("ul",{staticClass:"workshop-list"},t._l(t.workshopList,function(e,a){return s("li",[s("span",{staticClass:"name"},[t._v(t._s(e.name))]),t._v(" "),s("ul",{staticClass:"status-list"},[s("li",{class:2==e.status?"working":"",on:{click:function(s){t.setStatus(e,2)}}},[t._v("生产中")]),t._v(" "),s("li",{class:3==e.status?"stoping":"",on:{click:function(s){t.setStatus(e,3)}}},[t._v("停产中")]),t._v(" "),s("li",{class:1==e.status?"notwork":"",on:{click:function(s){t.setStatus(e,1)}}},[t._v("非生产")])])])}))]),t._v(" "),s("ul",{staticClass:"btn-list"},[s("li",{on:{click:function(e){t.resetList()}}},[t._v("重置")]),t._v(" "),s("li",{on:{click:function(e){t.confirmList()}}},[t._v("确认")])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("ul",{staticClass:"status-box"},[e("li",{staticClass:"working"},[this._v("生产中")]),this._v(" "),e("li",{staticClass:"stoping"},[this._v("停产中")]),this._v(" "),e("li",{staticClass:"notwork"},[this._v("非生产")])])}]},b=s("vSla")(C,L,!1,null,null,null).exports,x={name:"carSpace",data:function(){return{workspaceList:[],showMask:!1,workName:"",editItem:{},editFlag:-1}},methods:{getWorkshopList:function(t){t.$ajax({method:"GET",url:t.api+"/api/workshop?page=0&size=100&isDelete=0&sort=createTime,desc"}).then(function(e){t.workspaceList=e.data.data.content}).catch(function(t){console.log(t)})},deleteWorkshop:function(t){var e=this;e.$ajax({method:"delete",url:e.api+"/api/workshop/"+t}).then(function(t){0==t.data.code&&e.getWorkshopList(e),console.log(t)}).catch(function(t){console.log(t)})},editWorkshop:function(t){this.editFlag=1,this.showMask=!0,this.editItem=t,this.workName=t.name},hideWorkshop:function(){this.showMask=!1},showAdd:function(){this.editFlag=-1,this.showMask=!0,this.workName=""},confirmEdit:function(){var t=this;""!=t.workName?(1==this.editFlag&&(t.workspaceList.map(function(e,s){e.id==t.editItem.id&&(e.name=t.workName)}),t.$ajax({method:"PUT",url:t.api+"/api/workshop/all",data:t.workspaceList}).then(function(e){t.workName="",t.showMask=!1,console.log(e.data.data)}).catch(function(t){console.log(t)})),-1==this.editFlag&&t.$ajax({method:"post",url:t.api+"/api/workshop",data:{status:0,name:t.workName}}).then(function(e){t.workName="",t.showMask=!1,t.getWorkshopList(t)}).catch(function(t){console.log(t)})):alert("车间名称不为空")}},mounted:function(){var t=this;window.showAdd=function(){t.showAdd()}},created:function(){this.getWorkshopList(this)}},N={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"car-space"},[s("ul",{staticClass:"space-list"},t._l(t.workspaceList,function(e,a){return s("li",[s("span",{staticClass:"name"},[t._v(t._s(e.name))]),t._v(" "),s("div",{staticClass:"operator"},[s("span",{staticClass:"del",on:{click:function(s){t.deleteWorkshop(e.id)}}}),t._v(" "),s("span",{staticClass:"edit",on:{click:function(s){t.editWorkshop(e)}}})])])})),t._v(" "),t.showMask?s("div",{staticClass:"mask"}):t._e(),t._v(" "),t.showMask?s("div",{staticClass:"mask-box"},[s("p",{staticClass:"mask-tit"},[t._v("修改车间名称")]),t._v(" "),s("div",{staticClass:"mask-inputbox"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.workName,expression:"workName"}],staticClass:"mask-input",attrs:{placeholder:"请输入车间名称",type:"text",name:"",value:""},domProps:{value:t.workName},on:{input:function(e){e.target.composing||(t.workName=e.target.value)}}})]),t._v(" "),s("ul",{staticClass:"bottombtn-list"},[s("li",{on:{click:function(e){t.hideWorkshop()}}},[t._v("取消")]),t._v(" "),s("li",{on:{click:function(e){t.confirmEdit()}}},[t._v("确认")])])]):t._e()])},staticRenderFns:[]},M=s("vSla")(x,N,!1,null,null,null).exports;o.a.use(l.a);var T=new l.a({routes:[{path:"/record",name:"taskList",component:v,meta:{title:"操作记录"}},{path:"/",redirect:{name:"taskList"}},{path:"/member",name:"memberList",component:w,meta:{title:"成员管理"}},{path:"/workshop",name:"workshopState",component:b,meta:{title:"选择当前车间状态"}},{path:"/carspace",name:"carSpace",component:M,meta:{title:"管理车间"}}]});function E(t,e){if(t=t.replace(/-/g,"/"),0===arguments.length)return null;10===(t+"").length&&(t=1e3*+t);var s=e||"{y}-{m}-{d} {h}:{i}:{s}",a=new Date(t),i={y:a.getFullYear(),m:a.getMonth()+1,d:a.getDate(),h:a.getHours(),i:a.getMinutes(),s:a.getSeconds(),a:a.getDay()};return s.replace(/{(y|m|d|h|i|s|a)+}/g,function(t,e){var s=i[e];return"a"===e?["一","二","三","四","五","六","日"][s-1]:(t.length>0&&s<10&&(s="0"+s),s||0)})}function F(t,e){t=1e3*+t;var s=new Date(t),a=(Date.now()-s)/1e3;return a<30?"刚刚":a<3600?Math.ceil(a/60)+"分钟前":a<86400?Math.ceil(a/3600)+"小时前":a<172800?"1天前":e?E(t,e):s.getMonth()+1+"月"+s.getDate()+"日"+s.getHours()+"时"+s.getMinutes()+"分"}var y=s("aozt"),$=s.n(y);T.beforeEach(function(t,e,s){t.meta.title&&(document.title=t.meta.title),s()}),o.a.config.productionTip=!1,n()(a).forEach(function(t){o.a.filter(t,a[t])}),o.a.prototype.$ajax=$.a,o.a.prototype.api="http://120.24.183.106:9089",new o.a({el:"#app",router:T,components:{App:c},template:"<App/>"})}},["NHnr"]);
//# sourceMappingURL=app.f5cd36a8ea11bd4ad208.js.map