webpackJsonp([11],{KpQP:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("V/8j"),s={data:function(){var e=this,t=function(e,t,r){return t?t.length<6?r(new Error("密码长度不能少于6位")):t.length>16?r(new Error("密码长度不能大于16位")):/^\w+$/.test(t)?void r():r(new Error("密码格式不正确")):r(new Error("密码不能为空"))};return{list:null,listLoading:!1,searchUsername:"",searchName:"",searchStatus:"",dialogFormVisible:!1,editFlag:!1,dialogTitle:"",selectStatusOptions:[{id:1,name:"禁用"},{id:0,name:"启用"}],form:{username:"",newPassword:"",confirmPassword:""},rules:{newPassword:[{required:!0,validator:t,trigger:"blur"}],confirmPassword:[{required:!0,validator:function(t,r,a){return r?r.length<6?a(new Error("密码长度不能少于6位")):r.length>16?a(new Error("密码长度不能大于16位")):r!==e.form.newPassword?a(new Error("两次密码输入不一致")):void a():a(new Error("确认密码不能为空"))},trigger:"blur"}]},roleList:[],dialogFormVisible2:!1,dialogTitle2:"",editFlag2:!1,form2:{username:"",phone:"",addPassword:"",confirmPassword:"",email:""},rules2:{username:[{required:!0,message:"用户名不能为空",trigger:"blur"}],realName:[{required:!0,message:"用户姓名不能为空",trigger:"blur"}],addPassword:[{required:!0,validator:t,trigger:"blur"}],confirmPassword:[{required:!0,validator:function(t,r,a){return r?r.length<6?a(new Error("密码长度不能少于6位")):r.length>16?a(new Error("密码长度不能大于16位")):r!==e.form2.addPassword?a(new Error("两次密码输入不一致")):void a():a(new Error("确认密码不能为空"))},trigger:"blur"}],phone:[{required:!0,validator:function(e,t,r){return t?/^(0|86|17951)?(13[0-9]|15[012356789]|166|17[3678]|18[0-9]|14[57])[0-9]{8}$/.test(t)?void r():r(new Error("手机号码格式不正确")):r(new Error("手机号码不能为空"))},trigger:"blur"}],email:[{required:!0,validator:function(e,t,r){return t?/\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*/.test(t)?void r():r(new Error("邮箱格式不正确")):r(new Error("邮箱不能为空"))},trigger:"blur"}],status:[{required:!0,message:"请选择状态",trigger:"blur"}],roleId:[{required:!0,message:"请选择角色",trigger:"blur"}]},getRoleFlag:!1,editUserFlag:!1}},created:function(){this.fetchData()},methods:{getRoleName:function(e){var t="";return this.roleList.length>0&&this.roleList.map(function(r,a){r.id==e&&(t=r.name)}),t},userOperate:function(e,t){var r=this;this.dialogFormVisible2=!0,this.$refs.form2&&this.$refs.form2.clearValidate(),this.getRoleFlag||Object(a.k)().then(function(e){r.roleList=e.data.data,r.getRoleFlag=!0}),0==t?(this.editFlag2=!1,this.form2=e,this.dialogTitle2="查看【"+e.username+"】详情",this.editUserFlag=!1):1==t?(this.form2.username="",this.form2.realName="",this.form2.addPassword="",this.form2.confirmPassword="",this.form2.email="",this.form2.phone="",this.form2.status="",this.form2.remark="",this.form2.roleId="",this.dialogTitle2="新增用户",this.editFlag2=!0,this.editUserFlag=!1):-1==t&&(this.form2=e,this.editFlag2=!0,this.editUserFlag=!0,this.dialogTitle2="编辑用户")},submitRes:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;if(t.editUserFlag){var r={};r.id=t.form2.id,r.phone=t.form2.phone,r.realName=t.form2.realName,r.remark=t.form2.remark,r.roleId=t.form2.roleId,r.username=t.form2.username,r.email=t.form2.email,r.status=t.form2.status,Object(a.f)(r).then(function(e){200==e.status&&0==e.data.code?(t.$message({message:"修改成功",type:"success"}),t.dialogFormVisible2=!1,t.fetchData()):t.$message({message:e.data.message||"修改失敗",type:"warning"})})}else Object(a.a)(t.form2).then(function(e){200==e.status&&0==e.data.code?(t.$message({message:"添加成功",type:"success"}),t.dialogFormVisible2=!1,t.fetchData()):t.$message({message:e.data.message||"添加失敗",type:"warning"})})})},changeStatus:function(e){var t=this,r="确认"+(0==e.status?"禁用":"启用")+"【"+e.username+"】?";this.$confirm(r,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(a.f)({id:e.id,status:0==e.status?1:0}).then(function(r){200==r.status&&0==r.data.code?(t.$message({type:"success",message:"已"+(0==e.status?"禁用":"启用")+"!"}),t.fetchData()):t.$message({message:r.data.message||"操作失败",type:"warning"})})}).catch(function(){t.$message({type:"info",message:"已取消"+(0==e.status?"禁用":"启用")})})},fetchData:function(){var e=this;this.listLoading=!0,Object(a.h)().then(function(t){e.list=t.data.data,e.listLoading=!1})},changePassword:function(e){this.form=e,this.dialogFormVisible=!0,this.dialogTitle="重置【"+e.username+"】的密码"},submitPass:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;Object(a.c)("newPassword="+t.form.newPassword+"&id="+t.form.id).then(function(e){200==e.status&&0==e.data.code?(t.$message({message:"修改成功",type:"success"}),t.dialogFormVisible=!1,t.fetchData()):t.$message({message:e.data.message||"修改失敗",type:"warning"})})})}}},o={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[r("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-edit"},on:{click:function(t){e.userOperate(1,1)}}},[e._v("新增用户")]),e._v(" "),r("br"),r("br"),e._v(" "),r("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:e.listLoading,expression:"listLoading",modifiers:{body:!0}}],attrs:{data:e.list,"element-loading-text":"Loading",border:"",fit:"","highlight-current-row":""}},[r("el-table-column",{attrs:{align:"center",label:"编号"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.id)+"\n      ")]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"用户姓名名称",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.realName||"--")+"\n      ")]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"账号",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.username||"--")+"\n      ")]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"角色",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.roleName||"--")+"\n      ")]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(1==t.row.status?"已禁用":"已启用")+"\n      ")]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"创建时间",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.createTime)+"\n      ")]}}])}),e._v(" "),r("el-table-column",{attrs:{width:"380",fixed:"right",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(r){e.userOperate(t.row,0)}}},[e._v("查看")]),e._v(" "),r("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-edit"},on:{click:function(r){e.userOperate(t.row,-1)}}},[e._v("编辑")]),e._v(" "),r("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-edit"},on:{click:function(r){e.changePassword(t.row)}}},[e._v("重置密码")]),e._v(" "),r("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-edit"},on:{click:function(r){e.changeStatus(t.row)}}},[e._v(e._s(0==t.row.status?"禁用":"启用"))])]}}])})],1),e._v(" "),r("el-dialog",{attrs:{title:e.dialogTitle,visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[r("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules}},[r("el-form-item",{attrs:{label:"用户名：","label-width":"120px",prop:"name"}},[e._v(e._s(e.form.username))]),e._v(" "),r("el-form-item",{attrs:{label:"新密码：","label-width":"120px",prop:"newPassword"}},[e.editFlag?e._e():r("el-input",{staticStyle:{width:"85%"},attrs:{type:"password",placeholder:"请输入新密码","auto-complete":"off"},model:{value:e.form.newPassword,callback:function(t){e.$set(e.form,"newPassword",t)},expression:"form.newPassword"}}),e._v(" "),e.editFlag?r("span",[e._v(e._s(e.form.newPassword))]):e._e()],1),e._v(" "),r("el-form-item",{attrs:{label:"确认密码：","label-width":"120px",prop:"confirmPassword"}},[e.editFlag?e._e():r("el-input",{staticStyle:{width:"85%"},attrs:{type:"password",placeholder:"请输入确认密码","auto-complete":"off"},model:{value:e.form.confirmPassword,callback:function(t){e.$set(e.form,"confirmPassword",t)},expression:"form.confirmPassword"}}),e._v(" "),e.editFlag?r("span",[e._v(e._s(e.form.confirmPassword))]):e._e()],1)],1),e._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitPass("form")}}},[e._v("确 定")])],1)],1),e._v(" "),r("el-dialog",{attrs:{title:e.dialogTitle2,visible:e.dialogFormVisible2},on:{"update:visible":function(t){e.dialogFormVisible2=t}}},[r("el-form",{ref:"form2",staticStyle:{width:"85%"},attrs:{model:e.form2,rules:e.rules2}},[r("el-form-item",{attrs:{label:"用户名：",prop:"username","label-width":"120px"}},[e.editFlag2?r("el-input",{attrs:{disabled:e.editUserFlag,placeholder:"请输入用户名","auto-complete":"off"},model:{value:e.form2.username,callback:function(t){e.$set(e.form2,"username",t)},expression:"form2.username"}}):e._e(),e._v(" "),e.editFlag2?e._e():r("span",[e._v(e._s(e.form2.username||"--"))])],1),e._v(" "),r("el-form-item",{attrs:{label:"用户姓名：",prop:"realName","label-width":"120px"}},[e.editFlag2?r("el-input",{attrs:{placeholder:"请输入用户姓名","auto-complete":"off"},model:{value:e.form2.realName,callback:function(t){e.$set(e.form2,"realName",t)},expression:"form2.realName"}}):e._e(),e._v(" "),e.editFlag2?e._e():r("span",[e._v(e._s(e.form2.realName||"--"))])],1),e._v(" "),e.editFlag2&&!e.editUserFlag?r("el-form-item",{attrs:{label:"密码：",prop:"addPassword","label-width":"120px"}},[r("el-input",{attrs:{placeholder:"请输入密码",type:"password","auto-complete":"off"},model:{value:e.form2.addPassword,callback:function(t){e.$set(e.form2,"addPassword",t)},expression:"form2.addPassword"}})],1):e._e(),e._v(" "),e.editFlag2&&!e.editUserFlag?r("el-form-item",{attrs:{label:"确认密码：",prop:"confirmPassword","label-width":"120px"}},[r("el-input",{attrs:{placeholder:"请输入确认密码",type:"password","auto-complete":"off"},model:{value:e.form2.confirmPassword,callback:function(t){e.$set(e.form2,"confirmPassword",t)},expression:"form2.confirmPassword"}})],1):e._e(),e._v(" "),r("el-form-item",{attrs:{label:"邮箱：",prop:"email","label-width":"120px"}},[e.editFlag2?r("el-input",{attrs:{placeholder:"请输入邮箱","auto-complete":"off"},model:{value:e.form2.email,callback:function(t){e.$set(e.form2,"email",t)},expression:"form2.email"}}):e._e(),e._v(" "),e.editFlag2?e._e():r("span",[e._v(e._s(e.form2.email||"--"))])],1),e._v(" "),r("el-form-item",{attrs:{label:"手机号码：",prop:"phone","label-width":"120px"}},[e.editFlag2?r("el-input",{attrs:{placeholder:"请输入手机号码","auto-complete":"off"},model:{value:e.form2.phone,callback:function(t){e.$set(e.form2,"phone",t)},expression:"form2.phone"}}):e._e(),e._v(" "),e.editFlag2?e._e():r("span",[e._v(e._s(e.form2.phone||"--"))])],1),e._v(" "),r("el-form-item",{attrs:{label:"类型：","label-width":"120px",prop:"status"}},[e.editFlag2?r("el-select",{staticClass:"filter-item",staticStyle:{width:"50%"},attrs:{clearable:"",placeholder:"请选择"},model:{value:e.form2.status,callback:function(t){e.$set(e.form2,"status",t)},expression:"form2.status"}},e._l(e.selectStatusOptions,function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})):e._e(),e._v(" "),e.editFlag2?e._e():r("span",[e._v(e._s(1==e.form2.status?"已禁用":"已启用"))])],1),e._v(" "),r("el-form-item",{attrs:{label:"描述：",prop:"remark","label-width":"120px"}},[e.editFlag2?r("el-input",{attrs:{type:"textarea",rows:3,placeholder:"请输入描述"},model:{value:e.form2.remark,callback:function(t){e.$set(e.form2,"remark",t)},expression:"form2.remark"}}):e._e(),e._v(" "),e.editFlag2?e._e():r("span",[e._v(e._s(e.form2.remark||"--"))])],1),e._v(" "),r("el-form-item",{attrs:{label:"选择角色：","label-width":"120px",prop:"roleId"}},[e.editFlag2?r("el-select",{staticClass:"filter-item",staticStyle:{width:"50%"},attrs:{clearable:"",placeholder:"请选择"},model:{value:e.form2.roleId,callback:function(t){e.$set(e.form2,"roleId",t)},expression:"form2.roleId"}},e._l(e.roleList,function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})):e._e(),e._v(" "),e.editFlag2?e._e():r("span",[e._v(e._s(e.getRoleName(e.form2.roleId)||"--"))])],1)],1),e._v(" "),e.editFlag2?r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.dialogFormVisible2=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitRes("form2")}}},[e._v("确 定")])],1):e._e()],1)],1)},staticRenderFns:[]},l=r("VU/8")(s,o,!1,null,null,null);t.default=l.exports}});