webpackJsonp([3],{"5aCZ":function(t,e,a){"use strict";var i=a("TIfe"),n=a("2sCs"),r=a.n(n),o={name:"Tinymce",props:{id:{type:String,default:"tinymceEditor"},height:{type:Number,default:300},width:{type:Number,default:null},value:{type:String,default:""},data:function(){return{hasChange:!1,hasInit:!1}}},mounted:function(){var t=this,e=this;tinymce.init({selector:"#"+this.id,language:"zh_CN",height:this.height,width:this.width,menubar:!1,plugins:["advlist autolink lists link image imagetools charmap print preview anchor textcolor","searchreplace visualblocks code fullscreen textcolor colorpicker","insertdatetime media table contextmenu paste code help"],toolbar:["insert | undo redo | table styleselect | bold italic backcolor forecolor | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image | removeformat code"],images_upload_url:"postAcceptor.php",init_instance_callback:function(a){e.value&&a.setContent(e.value),e.hasInit=!0,a.on("NodeChange Change KeyUp",function(){t.hasChange=!0,t.$emit("input",a.getContent({format:"raw"}))})},images_upload_handler:function(t,e,a){r.a.defaults.headers.common.Authorization=Object(i.c)();var n=new FormData;n.append("file",t.blob()),r.a.post("http://47.106.224.185:8086/api/upload",n,{headers:{"Content-Type":"multipart/form-data"}}).then(function(t){var a=t.data.data;e(a)}).catch(function(t){console.log(t)})}})},watch:{value:function(t){var e=this;!this.hasChange&&this.hasInit&&this.$nextTick(function(){return tinymce.get(e.id).setContent(t)})}},destroyed:function(){tinymce.get(this.id).destroy()}},s={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"tinymce-container editor-container"},[e("textarea",{staticClass:"tinymce-textarea",attrs:{id:this.id}})])},staticRenderFns:[]};var l=a("/Xao")(o,s,!1,function(t){a("OGnf")},"data-v-061935f4",null);e.a=l.exports},OGnf:function(t,e,a){var i=a("bf/0");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a("8bSs")("746cb823",i,!0)},SVPU:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("dByW"),n={data:function(){return{dialogVisible2:!1,dialogImageUrl:"",editFlag:!1,baseURL:"http://47.106.224.185:8086/api/upload",form:{status:"normal"},rules:{title:[{required:!0,message:"广告名称不能为空",trigger:"blur"}],linkUrl:[{required:!0,validator:function(t,e,a){return e?/^https?:\/\/(([a-zA-Z0-9_-])+(\.)?)*(:\d+)?(\/((\.)?(\?)?=?&?[a-zA-Z0-9_-](\?)?)*)*$/i.test(e)?void a():a(new Error("链接格式不正确")):a(new Error("链接不能为空"))},trigger:"blur"}],content:[{required:!0,message:"广告图片不能为空",trigger:"blur"}]},edit:+this.$route.params.editid,flag:+this.$route.params.flag}},components:{Tinymce:a("5aCZ").a},created:function(){var t=this;-1==this.flag?(Object(i.c)({id:+this.$route.params.editid}).then(function(e){t.form=e.data.data}),this.$route.meta.title="编辑广告"):this.$route.meta.title="添加广告"},methods:{handlePictureCardPreview:function(t){this.dialogImageUrl=t,this.dialogVisible2=!0},goBack:function(){this.$router.go(-1)},beforeAvatarUpload:function(t){console.log(t);var e=["image/jpeg","image/gif","image/png"].includes(t.type);return e||this.$message.error("图片格式不正确!"),e},handleImageScucess:function(t,e,a){this.form.imageUrl=t.data},handleImageScucess2:function(t,e,a){this.form.contentImageUrl=t.data},submitRes:function(t){var e=this;this.$refs[t].validate(function(t){if(!t)return!1;-1==e.flag?Object(i.b)({id:e.form.id,title:e.form.title,linkUrl:e.form.linkUrl,imageUrl:e.form.imageUrl,contentImageUrl:e.form.contentImageUrl,status:e.form.status}).then(function(t){200==t.status&&0==t.data.code?(e.$message({message:"修改成功",type:"success"}),e.$router.push({name:"Ads"})):e.$message({message:t.data.message||"修改失敗",type:"warning"})}):Object(i.a)({title:e.form.title,linkUrl:e.form.linkUrl,imageUrl:e.form.imageUrl,contentImageUrl:e.form.contentImageUrl,status:e.form.status}).then(function(t){200==t.status&&0==t.data.code?(e.$message({message:"添加成功",type:"success"}),e.$router.push({name:"Ads"})):e.$message({message:t.data.message||"添加失敗",type:"warning"})})})}}},r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,"label-width":"120px"}},[a("el-form-item",{staticStyle:{width:"500px"},attrs:{label:"文章标题",prop:"title"}},[a("el-input",{attrs:{placeholder:"请输入文章标题"},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),t._v(" "),a("el-form-item",{staticStyle:{width:"500px"},attrs:{label:"链接",prop:"linkUrl"}},[a("el-input",{attrs:{placeholder:"请输入链接"},model:{value:t.form.linkUrl,callback:function(e){t.$set(t.form,"linkUrl",e)},expression:"form.linkUrl"}})],1),t._v(" "),a("el-form-item",{staticStyle:{width:"500px"},attrs:{label:"内容",prop:"content"}},[a("Tinymce",{ref:"editor",attrs:{height:550,width:800,id:"tinymce"},model:{value:t.form.content,callback:function(e){t.$set(t.form,"content",e)},expression:"form.content"}})],1),t._v(" "),a("el-form-item",{attrs:{label:""}},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submitRes("form")}}},[t._v("确定")]),t._v(" "),a("el-button",{on:{click:function(e){t.goBack()}}},[t._v("返回")])],1)],1),t._v(" "),a("el-dialog",{attrs:{visible:t.dialogVisible2},on:{"update:visible":function(e){t.dialogVisible2=e}}},[a("img",{attrs:{width:"100%",src:t.dialogImageUrl,alt:""}})])],1)},staticRenderFns:[]},o=a("/Xao")(n,r,!1,null,null,null);e.default=o.exports},"bf/0":function(t,e,a){(t.exports=a("BkJT")(!1)).push([t.i,"\n.tinymce-container[data-v-061935f4] {\n  position: relative\n}\n.tinymce-textarea[data-v-061935f4] {\n  visibility: hidden;\n  z-index: -1;\n}\n\n",""])},dByW:function(t,e,a){"use strict";e.d=function(t){return Object(r.a)({url:"/api/banner/search",method:"POST",data:n()(t),headers:{"Content-Type":"application/json;charset=utf-8"}})},e.c=function(t){return Object(r.a)({url:"/api/banner/"+t.id,method:"get",params:t})},e.a=function(t){return Object(r.a)({url:"/api/banner",method:"post",data:n()(t),headers:{"Content-Type":"application/json;charset=utf-8"}})},e.b=function(t){return Object(r.a)({url:"/api/banner",method:"PUT",data:n()(t),headers:{"Content-Type":"application/json;charset=utf-8"}})};var i=a("3cXf"),n=a.n(i),r=a("vLgD")}});